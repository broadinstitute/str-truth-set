+ python3 -m pip install -r requirements.txt -qq
+ set +x
===============
STEP #1: Filter SynDip truth set to SynDip high confidence regions
         INPUT: ./ref/full.38.vcf.gz        5182765 variants
+ bedtools intersect -header -f 1 -wa -u -a ./ref/full.38.vcf.gz -b ./ref/full.38.bed.gz
+ bgzip
+ set +x
         OUTPUT: step1.high_confidence_regions.vcf.gz         4085178 variants
VCF stats for the input vcf -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --  ./ref/full.38.vcf.gz
 5,182,765 TOTAL variants
 5,362,620 TOTAL alleles (1.03 alleles per variant)
--------------
 1,733,759 out of  5,182,765 ( 33.5%) genotype: 1|1
 1,504,467 out of  5,182,765 ( 29.0%) genotype: 0|1
 1,495,334 out of  5,182,765 ( 28.9%) genotype: 1|0
   115,177 out of  5,182,765 (  2.2%) genotype: 1|.
    89,241 out of  5,182,765 (  1.7%) genotype: 2|1
    86,403 out of  5,182,765 (  1.7%) genotype: 1|2
    58,317 out of  5,182,765 (  1.1%) genotype: .|1
    43,013 out of  5,182,765 (  0.8%) genotype: .|.
    33,528 out of  5,182,765 (  0.6%) genotype: .|0
    22,555 out of  5,182,765 (  0.4%) genotype: 0|.
       695 out of  5,182,765 (  0.0%) genotype: .|2
       203 out of  5,182,765 (  0.0%) genotype: 2|.
        52 out of  5,182,765 (  0.0%) genotype: .|3
        21 out of  5,182,765 (  0.0%) genotype: 3|.
--------------
 5,182,765 out of  5,182,765 (100.0%) TOTAL variants
 4,018,563 out of  5,182,765 ( 77.5%) SNV variants
   505,154 out of  5,182,765 (  9.7%) DEL variants
   479,474 out of  5,182,765 (  9.3%) INS variants
    56,620 out of  5,182,765 (  1.1%) multiallelic INS variants
    42,103 out of  5,182,765 (  0.8%) multiallelic DEL variants
    41,097 out of  5,182,765 (  0.8%) mixed multiallelic INS/DEL variants
    26,071 out of  5,182,765 (  0.5%) multiallelic SNV variants
    11,384 out of  5,182,765 (  0.2%) mixed multiallelic INS/SNV variants
     2,293 out of  5,182,765 (  0.0%) mixed multiallelic DEL/SNV variants
         6 out of  5,182,765 (  0.0%) mixed multiallelic INS/DEL/SNV variants
--------------
 5,362,620 out of  5,362,620 (100.0%) TOTAL alleles
 4,082,099 out of  5,362,620 ( 76.1%) SNV alleles
   645,344 out of  5,362,620 ( 12.0%) INS alleles
   632,876 out of  5,362,620 ( 11.8%) DEL alleles
     2,301 out of  5,362,620 (  0.0%) MNV alleles
VCF stats for the output vcf -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --  step1.high_confidence_regions.vcf.gz
 4,085,178 TOTAL variants
 4,152,492 TOTAL alleles (1.02 alleles per variant)
--------------
 1,533,140 out of  4,085,178 ( 37.5%) genotype: 1|1
 1,247,174 out of  4,085,178 ( 30.5%) genotype: 1|0
 1,237,550 out of  4,085,178 ( 30.3%) genotype: 0|1
    33,661 out of  4,085,178 (  0.8%) genotype: 1|2
    33,653 out of  4,085,178 (  0.8%) genotype: 2|1
--------------
 4,085,178 out of  4,085,178 (100.0%) TOTAL variants
 3,547,658 out of  4,085,178 ( 86.8%) SNV variants
   236,881 out of  4,085,178 (  5.8%) INS variants
   233,325 out of  4,085,178 (  5.7%) DEL variants
    17,148 out of  4,085,178 (  0.4%) multiallelic INS variants
    16,995 out of  4,085,178 (  0.4%) multiallelic DEL variants
    15,775 out of  4,085,178 (  0.4%) multiallelic SNV variants
    10,720 out of  4,085,178 (  0.3%) mixed multiallelic INS/DEL variants
     5,585 out of  4,085,178 (  0.1%) mixed multiallelic INS/SNV variants
     1,091 out of  4,085,178 (  0.0%) mixed multiallelic DEL/SNV variants
--------------
 4,152,492 out of  4,152,492 (100.0%) TOTAL alleles
 3,584,793 out of  4,152,492 ( 86.3%) SNV alleles
   287,482 out of  4,152,492 (  6.9%) INS alleles
   279,126 out of  4,152,492 (  6.7%) DEL alleles
     1,091 out of  4,152,492 (  0.0%) MNV alleles
===============
STEP #2: Filter variants to the subset that are actually STR expansion or contractions
         INPUT: step1.high_confidence_regions.vcf.gz        4085178 variants
+ python3 -u -m str_analysis.filter_vcf_to_STR_variants -R ./ref/hg38.fa --write-bed-file --min-fraction-of-variant-covered-by-repeat 1 --min-str-length 9 --min-str-repeats 3 --output-prefix step2.STRs step1.high_confidence_regions.vcf.gz
WARNING: Multi-allelic STR INS RU2:AC:INS:8=>11 has alleles with different repeat_units: AT, ATATATATATATTTCACATAATGTGGAAT   Skipping...
WARNING: Multi-allelic STR DEL RU8:AAAAAAAC:DEL:4=>3 has alleles with different repeat_units: AGGAGGAGAGAGG, AGG   Skipping...
WARNING: Multi-allelic STR DEL RU3:TTC:DEL:7=>6 has alleles with different repeat_units: GTCTTTCATCTGGTCTGGATGAAAGACCAGAT, GTCTTTCATCTGGTCTGGATGAAAGACCGGAT   Skipping...
WARNING: Multi-allelic STR INS:INS RU2:TG:INS,INS:19=>20,21 has alleles with different repeat_units: CCAC, CCACCCACCCACCATCCATCCAC   Skipping...
WARNING: Multi-allelic STR DEL RU4:GGAG:DEL:8=>5 has alleles with different repeat_units: CGGCGGCGGCGGCGGGCAGGGCGGGGCCGG, CGG   Skipping...
2022-11-26 21:45:35,667 INFO: --------------
2022-11-26 21:45:35,668 INFO:    181,064 out of    181,064 (100.0%) STR allele counts: TOTAL
2022-11-26 21:45:35,668 INFO:     90,780 out of    181,064 ( 50.1%) STR allele counts: DEL
2022-11-26 21:45:35,668 INFO:     90,284 out of    181,064 ( 49.9%) STR allele counts: INS
2022-11-26 21:45:35,668 INFO: --------------
2022-11-26 21:45:35,669 INFO:     95,675 out of    181,064 ( 52.8%) STR allele delta: 1 repeats
2022-11-26 21:45:35,669 INFO:     35,335 out of    181,064 ( 19.5%) STR allele delta: 2 repeats
2022-11-26 21:45:35,669 INFO:     17,893 out of    181,064 (  9.9%) STR allele delta: 3 repeats
2022-11-26 21:45:35,669 INFO:     10,536 out of    181,064 (  5.8%) STR allele delta: 4 repeats
2022-11-26 21:45:35,669 INFO:      6,691 out of    181,064 (  3.7%) STR allele delta: 5 repeats
2022-11-26 21:45:35,669 INFO:      5,535 out of    181,064 (  3.1%) STR allele delta: 9+ repeats
2022-11-26 21:45:35,669 INFO:      4,348 out of    181,064 (  2.4%) STR allele delta: 6 repeats
2022-11-26 21:45:35,669 INFO:      2,985 out of    181,064 (  1.6%) STR allele delta: 7 repeats
2022-11-26 21:45:35,669 INFO:      2,066 out of    181,064 (  1.1%) STR allele delta: 8 repeats
2022-11-26 21:45:35,669 INFO: --------------
2022-11-26 21:45:35,669 INFO:    107,594 out of    181,064 ( 59.4%) STR allele motif size: 2 bp
2022-11-26 21:45:35,669 INFO:     40,439 out of    181,064 ( 22.3%) STR allele motif size: 4 bp
2022-11-26 21:45:35,669 INFO:     14,888 out of    181,064 (  8.2%) STR allele motif size: 3 bp
2022-11-26 21:45:35,669 INFO:      9,685 out of    181,064 (  5.3%) STR allele motif size: 5 bp
2022-11-26 21:45:35,669 INFO:      4,538 out of    181,064 (  2.5%) STR allele motif size: 9+ bp
2022-11-26 21:45:35,669 INFO:      2,627 out of    181,064 (  1.5%) STR allele motif size: 6 bp
2022-11-26 21:45:35,669 INFO:        735 out of    181,064 (  0.4%) STR allele motif size: 7 bp
2022-11-26 21:45:35,669 INFO:        558 out of    181,064 (  0.3%) STR allele motif size: 8 bp
2022-11-26 21:45:35,669 INFO: --------------
2022-11-26 21:45:35,669 INFO:    181,064 out of    181,064 (100.0%) STR allele purity: perfect repeats
2022-11-26 21:45:35,669 INFO: --------------
2022-11-26 21:45:35,669 INFO:    180,316 out of    181,064 ( 99.6%) STR allele reference repeats: with right matching ref. repeat
2022-11-26 21:45:35,669 INFO:        747 out of    181,064 (  0.4%) STR allele reference repeats: with no matching ref. repeat
2022-11-26 21:45:35,669 INFO:          1 out of    181,064 (  0.0%) STR allele reference repeats: with both left and right matching ref. repeat
2022-11-26 21:45:35,669 INFO: --------------
2022-11-26 21:45:35,670 INFO:    175,498 out of    181,064 ( 96.9%) STR allele size: 0-25bp
2022-11-26 21:45:35,670 INFO:      4,142 out of    181,064 (  2.3%) STR allele size: 25-50bp
2022-11-26 21:45:35,670 INFO:        664 out of    181,064 (  0.4%) STR allele size: 50-75bp
2022-11-26 21:45:35,670 INFO:        255 out of    181,064 (  0.1%) STR allele size: 75-100bp
2022-11-26 21:45:35,670 INFO:        144 out of    181,064 (  0.1%) STR allele size: 100-125bp
2022-11-26 21:45:35,670 INFO:         93 out of    181,064 (  0.1%) STR allele size: 125-150bp
2022-11-26 21:45:35,670 INFO:         66 out of    181,064 (  0.0%) STR allele size: 150-175bp
2022-11-26 21:45:35,670 INFO:         44 out of    181,064 (  0.0%) STR allele size: 175-200bp
2022-11-26 21:45:35,670 INFO:         33 out of    181,064 (  0.0%) STR allele size: 200-225bp
2022-11-26 21:45:35,670 INFO:         30 out of    181,064 (  0.0%) STR allele size: 225-250bp
2022-11-26 21:45:35,670 INFO:         19 out of    181,064 (  0.0%) STR allele size: 250-275bp
2022-11-26 21:45:35,670 INFO:         14 out of    181,064 (  0.0%) STR allele size: 275-300bp
2022-11-26 21:45:35,670 INFO:         14 out of    181,064 (  0.0%) STR allele size: 500+bp
2022-11-26 21:45:35,670 INFO:         11 out of    181,064 (  0.0%) STR allele size: 350-375bp
2022-11-26 21:45:35,670 INFO:          9 out of    181,064 (  0.0%) STR allele size: 425-450bp
2022-11-26 21:45:35,670 INFO:          7 out of    181,064 (  0.0%) STR allele size: 325-350bp
2022-11-26 21:45:35,670 INFO:          7 out of    181,064 (  0.0%) STR allele size: 375-400bp
2022-11-26 21:45:35,670 INFO:          5 out of    181,064 (  0.0%) STR allele size: 450-475bp
2022-11-26 21:45:35,670 INFO:          3 out of    181,064 (  0.0%) STR allele size: 300-325bp
2022-11-26 21:45:35,670 INFO:          3 out of    181,064 (  0.0%) STR allele size: 400-425bp
2022-11-26 21:45:35,670 INFO:          3 out of    181,064 (  0.0%) STR allele size: 475-500bp
2022-11-26 21:45:35,670 INFO: --------------
2022-11-26 21:45:35,670 INFO:     95,675 out of    181,064 ( 52.8%) STR allele source: found by NoRepeatFoundInVariantBases
2022-11-26 21:45:35,670 INFO:     85,389 out of    181,064 ( 47.2%) STR allele source: found by BruteForce
2022-11-26 21:45:35,670 INFO: --------------
2022-11-26 21:45:35,670 INFO:    146,618 out of    146,618 (100.0%) STR variant counts: TOTAL
2022-11-26 21:45:35,670 INFO:     30,751 out of    146,618 ( 21.0%) STR variant counts: multi-allelic
2022-11-26 21:45:35,670 INFO: --------------
2022-11-26 21:45:35,671 INFO:  3,570,342 out of  4,133,158 ( 86.4%) non-STR allele: SNV
2022-11-26 21:45:35,671 INFO:    177,733 out of  4,133,158 (  4.3%) non-STR allele: allele repeat sequence is too short
2022-11-26 21:45:35,671 INFO:     93,930 out of  4,133,158 (  2.3%) non-STR allele: 1bp INS
2022-11-26 21:45:35,671 INFO:     87,908 out of  4,133,158 (  2.1%) non-STR allele: 1bp DEL
2022-11-26 21:45:35,671 INFO:     21,090 out of  4,133,158 (  0.5%) non-STR allele: homopolymer
2022-11-26 21:45:35,671 INFO:      1,091 out of  4,133,158 (  0.0%) non-STR allele: MNV
2022-11-26 21:45:35,671 INFO: --------------
2022-11-26 21:45:35,671 INFO:  3,934,870 out of  4,085,178 ( 96.3%) skipped variant: no repeat units found in variant
2022-11-26 21:45:35,671 INFO:      3,685 out of  4,085,178 (  0.1%) skipped variant: mixed STR/non-STR multi-allelic variant
2022-11-26 21:45:35,671 INFO:          5 out of  4,085,178 (  0.0%) skipped variant: multi-allelic with different RepeatUnits
Finished writing to  step2.STRs.variants.tsv
Finished writing to  step2.STRs.alleles.tsv
Wrote 146618 to step2.STRs.variants.bed.gz
+ python3 -u scripts/compute_overlap_with_other_catalogs.py step2.STRs.variants.tsv.gz step2.STRs.variants.with_overlap_columns.tsv.gz -c IlluminaSTRCatalog -c GangSTRCatalog17 -c KnownDiseaseAssociatedSTRs
Parsed    174,300 intervals from IlluminaSTRCatalog                       ./ref/other/illumina_variant_catalog.sorted.bed.gz
Parsed  1,340,266 intervals from GangSTRCatalog17                         ./ref/other/hg38_ver17.fixed.bed.gz
Parsed         60 intervals from KnownDiseaseAssociatedSTRs               ./ref/other/known_disease_associated_STR_loci.GRCh38.bed.gz
Processing rows from step2.STRs.variants.tsv.gz
Wrote 146,618 rows to the output tsv: step2.STRs.variants.with_overlap_columns.tsv.gz
GangSTRCatalog17              :     81,705 out of    146,618 ( 55.7%) truth set loci, and out of  1,340,266 (  6.1%) GangSTRCatalog17 loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif
GangSTRCatalog17              :      1,003 out of    146,618 (  0.7%) truth set loci, and out of  1,340,266 (  0.1%) GangSTRCatalog17 loci:     STR locus is contained within truth set STR locus             and has same motif after normalization
GangSTRCatalog17              :         54 out of    146,618 (  0.0%) truth set loci, and out of  1,340,266 (  0.0%) GangSTRCatalog17 loci:     STR locus is contained within truth set STR locus             and has different motif
GangSTRCatalog17              :         39 out of    146,618 (  0.0%) truth set loci, and out of  1,340,266 (  0.0%) GangSTRCatalog17 loci:     STR locus contains truth set STR locus                        and has different motif
GangSTRCatalog17              :          2 out of    146,618 (  0.0%) truth set loci, and out of  1,340,266 (  0.0%) GangSTRCatalog17 loci:     STR locus contains truth set STR locus                        and has same motif
GangSTRCatalog17              :      1,979 out of    146,618 (  1.3%) truth set loci, and out of  1,340,266 (  0.1%) GangSTRCatalog17 loci:     STR loci overlap                                              and has different motif
GangSTRCatalog17              :      1,336 out of    146,618 (  0.9%) truth set loci, and out of  1,340,266 (  0.1%) GangSTRCatalog17 loci:     STR loci overlap                                              and has same motif after normalization
GangSTRCatalog17              :          3 out of    146,618 (  0.0%) truth set loci, and out of  1,340,266 (  0.0%) GangSTRCatalog17 loci:     STR loci overlap                                              and has same motif
GangSTRCatalog17              :     60,497 out of    146,618 ( 41.3%) truth set loci:     no overlap                                                  
IlluminaSTRCatalog            :     87,212 out of    146,618 ( 59.5%) truth set loci, and out of    174,300 ( 50.0%) IlluminaSTRCatalog loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif
IlluminaSTRCatalog            :        888 out of    146,618 (  0.6%) truth set loci, and out of    174,300 (  0.5%) IlluminaSTRCatalog loci:     STR locus is contained within truth set STR locus             and has same motif
IlluminaSTRCatalog            :         32 out of    146,618 (  0.0%) truth set loci, and out of    174,300 (  0.0%) IlluminaSTRCatalog loci:     STR locus is contained within truth set STR locus             and has same motif after normalization
IlluminaSTRCatalog            :         25 out of    146,618 (  0.0%) truth set loci, and out of    174,300 (  0.0%) IlluminaSTRCatalog loci:     STR locus is contained within truth set STR locus             and has different motif
IlluminaSTRCatalog            :      3,336 out of    146,618 (  2.3%) truth set loci, and out of    174,300 (  1.9%) IlluminaSTRCatalog loci:     STR locus contains truth set STR locus                        and has same motif
IlluminaSTRCatalog            :         92 out of    146,618 (  0.1%) truth set loci, and out of    174,300 (  0.1%) IlluminaSTRCatalog loci:     STR locus contains truth set STR locus                        and has same motif after normalization
IlluminaSTRCatalog            :         24 out of    146,618 (  0.0%) truth set loci, and out of    174,300 (  0.0%) IlluminaSTRCatalog loci:     STR locus contains truth set STR locus                        and has different motif
IlluminaSTRCatalog            :        183 out of    146,618 (  0.1%) truth set loci, and out of    174,300 (  0.1%) IlluminaSTRCatalog loci:     STR loci overlap                                              and has different motif
IlluminaSTRCatalog            :        158 out of    146,618 (  0.1%) truth set loci, and out of    174,300 (  0.1%) IlluminaSTRCatalog loci:     STR loci overlap                                              and has same motif after normalization
IlluminaSTRCatalog            :         53 out of    146,618 (  0.0%) truth set loci, and out of    174,300 (  0.0%) IlluminaSTRCatalog loci:     STR loci overlap                                              and has same motif
IlluminaSTRCatalog            :     54,615 out of    146,618 ( 37.2%) truth set loci:     no overlap                                                  
KnownDiseaseAssociatedSTRs    :         10 out of    146,618 (  0.0%) truth set loci, and out of         60 ( 16.7%) KnownDiseaseAssociatedSTRs loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif
KnownDiseaseAssociatedSTRs    :          3 out of    146,618 (  0.0%) truth set loci, and out of         60 (  5.0%) KnownDiseaseAssociatedSTRs loci:     STR locus is contained within truth set STR locus             and has same motif after normalization
KnownDiseaseAssociatedSTRs    :          4 out of    146,618 (  0.0%) truth set loci, and out of         60 (  6.7%) KnownDiseaseAssociatedSTRs loci:     STR locus contains truth set STR locus                        and has same motif
KnownDiseaseAssociatedSTRs    :          3 out of    146,618 (  0.0%) truth set loci, and out of         60 (  5.0%) KnownDiseaseAssociatedSTRs loci:     STR locus contains truth set STR locus                        and has same motif after normalization
KnownDiseaseAssociatedSTRs    :          3 out of    146,618 (  0.0%) truth set loci, and out of         60 (  5.0%) KnownDiseaseAssociatedSTRs loci:     STR loci overlap                                              and has same motif after normalization
KnownDiseaseAssociatedSTRs    :          1 out of    146,618 (  0.0%) truth set loci, and out of         60 (  1.7%) KnownDiseaseAssociatedSTRs loci:     STR loci overlap                                              and has different motif
KnownDiseaseAssociatedSTRs    :    146,594 out of    146,618 (100.0%) truth set loci:     no overlap                                                  
Done
+ set +x
         OUTPUT: step2.STRs.vcf.gz         146618 variants
VCF stats for the input vcf -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --  step1.high_confidence_regions.vcf.gz
 4,085,178 TOTAL variants
 4,152,492 TOTAL alleles (1.02 alleles per variant)
--------------
 1,533,140 out of  4,085,178 ( 37.5%) genotype: 1|1
 1,247,174 out of  4,085,178 ( 30.5%) genotype: 1|0
 1,237,550 out of  4,085,178 ( 30.3%) genotype: 0|1
    33,661 out of  4,085,178 (  0.8%) genotype: 1|2
    33,653 out of  4,085,178 (  0.8%) genotype: 2|1
--------------
 4,085,178 out of  4,085,178 (100.0%) TOTAL variants
 3,547,658 out of  4,085,178 ( 86.8%) SNV variants
   236,881 out of  4,085,178 (  5.8%) INS variants
   233,325 out of  4,085,178 (  5.7%) DEL variants
    17,148 out of  4,085,178 (  0.4%) multiallelic INS variants
    16,995 out of  4,085,178 (  0.4%) multiallelic DEL variants
    15,775 out of  4,085,178 (  0.4%) multiallelic SNV variants
    10,720 out of  4,085,178 (  0.3%) mixed multiallelic INS/DEL variants
     5,585 out of  4,085,178 (  0.1%) mixed multiallelic INS/SNV variants
     1,091 out of  4,085,178 (  0.0%) mixed multiallelic DEL/SNV variants
--------------
 4,152,492 out of  4,152,492 (100.0%) TOTAL alleles
 3,584,793 out of  4,152,492 ( 86.3%) SNV alleles
   287,482 out of  4,152,492 (  6.9%) INS alleles
   279,126 out of  4,152,492 (  6.7%) DEL alleles
     1,091 out of  4,152,492 (  0.0%) MNV alleles
VCF stats for the output vcf -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --  step2.STRs.vcf.gz
   146,618 TOTAL variants
   177,369 TOTAL alleles (1.21 alleles per variant)
--------------
    41,741 out of    146,618 ( 28.5%) genotype: 1|1
    37,308 out of    146,618 ( 25.4%) genotype: 0|1
    36,818 out of    146,618 ( 25.1%) genotype: 1|0
    15,592 out of    146,618 ( 10.6%) genotype: 1|2
    15,159 out of    146,618 ( 10.3%) genotype: 2|1
--------------
   146,618 out of    146,618 (100.0%) TOTAL variants
    58,275 out of    146,618 ( 39.7%) DEL variants
    57,592 out of    146,618 ( 39.3%) INS variants
    10,844 out of    146,618 (  7.4%) multiallelic DEL variants
    10,284 out of    146,618 (  7.0%) multiallelic INS variants
     9,623 out of    146,618 (  6.6%) mixed multiallelic INS/DEL variants
--------------
   177,369 out of    177,369 (100.0%) TOTAL alleles
    89,586 out of    177,369 ( 50.5%) DEL alleles
    87,783 out of    177,369 ( 49.5%) INS alleles
===============
STEP #3: Liftover variants from hg38 to the T2T reference (chm13v2.0)
         INPUT: step2.STRs.vcf.gz        146618 variants
+ gatk --java-options -Xmx7g LiftoverVcf -R ./ref/chm13v2.0.fa -C ./ref/hg38-chm13v2.chain -I step2.STRs.vcf.gz -O step3.STRs.lifted_to_chm13v2.vcf.gz --REJECT step3.lifted_to_chm13v2_rejected.vcf.gz --VALIDATION_STRINGENCY LENIENT --RECOVER_SWAPPED_REF_ALT --WARN_ON_MISSING_CONTIG --LIFTOVER_MIN_MATCH 0.00001 --WRITE_ORIGINAL_POSITION --WRITE_ORIGINAL_ALLELES --ALLOW_MISSING_FIELDS_IN_HEADER
21:48:07.907 INFO  NativeLibraryLoader - Loading libgkl_compression.dylib from jar:file:/Users/weisburd/bin/gatk-package-4.2.0.0-local.jar!/com/intel/gkl/native/libgkl_compression.dylib
[Sat Nov 26 21:48:08 EST 2022] LiftoverVcf --INPUT step2.STRs.vcf.gz --OUTPUT step3.STRs.lifted_to_chm13v2.vcf.gz --CHAIN ./ref/hg38-chm13v2.chain --REJECT step3.lifted_to_chm13v2_rejected.vcf.gz --WARN_ON_MISSING_CONTIG true --WRITE_ORIGINAL_POSITION true --WRITE_ORIGINAL_ALLELES true --LIFTOVER_MIN_MATCH 1.0E-5 --ALLOW_MISSING_FIELDS_IN_HEADER true --RECOVER_SWAPPED_REF_ALT true --VALIDATION_STRINGENCY LENIENT --REFERENCE_SEQUENCE ./ref/chm13v2.0.fa --LOG_FAILED_INTERVALS true --TAGS_TO_REVERSE AF --TAGS_TO_DROP MAX_AF --DISABLE_SORT false --VERBOSITY INFO --QUIET false --COMPRESSION_LEVEL 2 --MAX_RECORDS_IN_RAM 500000 --CREATE_INDEX false --CREATE_MD5_FILE false --GA4GH_CLIENT_SECRETS client_secrets.json --help false --version false --showHidden false --USE_JDK_DEFLATER false --USE_JDK_INFLATER false
[Sat Nov 26 21:48:08 EST 2022] Executing as weisburd@wm103-772 on Mac OS X 10.16 x86_64; OpenJDK 64-Bit Server VM 1.8.0_322-b06; Deflater: Intel; Inflater: Intel; Provider GCS is available; Picard version: Version:4.2.0.0
INFO	2022-11-26 21:48:09	LiftoverVcf	Loading up the target reference genome.
INFO	2022-11-26 21:48:20	LiftoverVcf	Lifting variants over and sorting (not yet writing the output file.)
INFO	2022-11-26 21:48:27	LiftoverVcf	Processed 146618 variants.
INFO	2022-11-26 21:48:27	LiftoverVcf	61474 variants failed to liftover.
INFO	2022-11-26 21:48:27	LiftoverVcf	623 variants lifted over but had mismatching reference alleles after lift over.
INFO	2022-11-26 21:48:27	LiftoverVcf	42.3529% of variants were not successfully lifted over and written to the output.
INFO	2022-11-26 21:48:27	LiftoverVcf	liftover success by source contig:
INFO	2022-11-26 21:48:27	LiftoverVcf	chr1: 6487 / 11465 (56.5809%)
INFO	2022-11-26 21:48:27	LiftoverVcf	chr10: 3955 / 6929 (57.0789%)
INFO	2022-11-26 21:48:27	LiftoverVcf	chr11: 3791 / 6705 (56.5399%)
INFO	2022-11-26 21:48:27	LiftoverVcf	chr12: 4013 / 7046 (56.9543%)
INFO	2022-11-26 21:48:27	LiftoverVcf	chr13: 3008 / 5366 (56.0567%)
INFO	2022-11-26 21:48:27	LiftoverVcf	chr14: 2673 / 4654 (57.4345%)
INFO	2022-11-26 21:48:27	LiftoverVcf	chr15: 2313 / 4006 (57.7384%)
INFO	2022-11-26 21:48:27	LiftoverVcf	chr16: 2449 / 4283 (57.1795%)
INFO	2022-11-26 21:48:27	LiftoverVcf	chr17: 2428 / 4225 (57.4675%)
INFO	2022-11-26 21:48:27	LiftoverVcf	chr18: 2313 / 4069 (56.8444%)
INFO	2022-11-26 21:48:27	LiftoverVcf	chr19: 1919 / 3269 (58.7030%)
INFO	2022-11-26 21:48:27	LiftoverVcf	chr2: 6875 / 12018 (57.2059%)
INFO	2022-11-26 21:48:27	LiftoverVcf	chr20: 1971 / 3286 (59.9817%)
INFO	2022-11-26 21:48:27	LiftoverVcf	chr21: 1165 / 1952 (59.6824%)
INFO	2022-11-26 21:48:27	LiftoverVcf	chr22: 1117 / 1870 (59.7326%)
INFO	2022-11-26 21:48:27	LiftoverVcf	chr3: 5765 / 9915 (58.1442%)
INFO	2022-11-26 21:48:27	LiftoverVcf	chr4: 5561 / 9802 (56.7333%)
INFO	2022-11-26 21:48:27	LiftoverVcf	chr5: 5286 / 8943 (59.1077%)
INFO	2022-11-26 21:48:27	LiftoverVcf	chr6: 5047 / 8637 (58.4346%)
INFO	2022-11-26 21:48:27	LiftoverVcf	chr7: 4537 / 7945 (57.1051%)
INFO	2022-11-26 21:48:27	LiftoverVcf	chr8: 4273 / 7319 (58.3823%)
INFO	2022-11-26 21:48:27	LiftoverVcf	chr9: 3338 / 5688 (58.6850%)
INFO	2022-11-26 21:48:27	LiftoverVcf	chrX: 4237 / 7226 (58.6355%)
INFO	2022-11-26 21:48:27	LiftoverVcf	lifted variants by target contig:
INFO	2022-11-26 21:48:27	LiftoverVcf	chr1: 6487
INFO	2022-11-26 21:48:27	LiftoverVcf	chr10: 3955
INFO	2022-11-26 21:48:27	LiftoverVcf	chr11: 3791
INFO	2022-11-26 21:48:27	LiftoverVcf	chr12: 4013
INFO	2022-11-26 21:48:27	LiftoverVcf	chr13: 3008
INFO	2022-11-26 21:48:27	LiftoverVcf	chr14: 2673
INFO	2022-11-26 21:48:27	LiftoverVcf	chr15: 2313
INFO	2022-11-26 21:48:27	LiftoverVcf	chr16: 2449
INFO	2022-11-26 21:48:27	LiftoverVcf	chr17: 2428
INFO	2022-11-26 21:48:27	LiftoverVcf	chr18: 2313
INFO	2022-11-26 21:48:27	LiftoverVcf	chr19: 1919
INFO	2022-11-26 21:48:27	LiftoverVcf	chr2: 6875
INFO	2022-11-26 21:48:27	LiftoverVcf	chr20: 1971
INFO	2022-11-26 21:48:27	LiftoverVcf	chr21: 1165
INFO	2022-11-26 21:48:27	LiftoverVcf	chr22: 1117
INFO	2022-11-26 21:48:27	LiftoverVcf	chr3: 5765
INFO	2022-11-26 21:48:27	LiftoverVcf	chr4: 5561
INFO	2022-11-26 21:48:27	LiftoverVcf	chr5: 5286
INFO	2022-11-26 21:48:27	LiftoverVcf	chr6: 5047
INFO	2022-11-26 21:48:27	LiftoverVcf	chr7: 4537
INFO	2022-11-26 21:48:27	LiftoverVcf	chr8: 4273
INFO	2022-11-26 21:48:27	LiftoverVcf	chr9: 3338
INFO	2022-11-26 21:48:27	LiftoverVcf	chrX: 4237
INFO	2022-11-26 21:48:27	LiftoverVcf	0 variants were lifted by swapping REF/ALT alleles.
INFO	2022-11-26 21:48:27	LiftoverVcf	Writing out sorted records to final VCF.
[Sat Nov 26 21:48:28 EST 2022] picard.vcf.LiftoverVcf done. Elapsed time: 0.34 minutes.
Runtime.totalMemory()=4570742784
Tool returned:
0
Using GATK jar /Users/weisburd/bin/gatk-package-4.2.0.0-local.jar
Running:
    java -Dsamjdk.use_async_io_read_samtools=false -Dsamjdk.use_async_io_write_samtools=true -Dsamjdk.use_async_io_write_tribble=false -Dsamjdk.compression_level=2 -Xmx7g -jar /Users/weisburd/bin/gatk-package-4.2.0.0-local.jar LiftoverVcf -R ./ref/chm13v2.0.fa -C ./ref/hg38-chm13v2.chain -I step2.STRs.vcf.gz -O step3.STRs.lifted_to_chm13v2.vcf.gz --REJECT step3.lifted_to_chm13v2_rejected.vcf.gz --VALIDATION_STRINGENCY LENIENT --RECOVER_SWAPPED_REF_ALT --WARN_ON_MISSING_CONTIG --LIFTOVER_MIN_MATCH 0.00001 --WRITE_ORIGINAL_POSITION --WRITE_ORIGINAL_ALLELES --ALLOW_MISSING_FIELDS_IN_HEADER
+ set +x
         OUTPUT: step3.STRs.lifted_to_chm13v2.vcf.gz         84521 variants
VCF stats for the input vcf -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --  step2.STRs.vcf.gz
   146,618 TOTAL variants
   177,369 TOTAL alleles (1.21 alleles per variant)
--------------
    41,741 out of    146,618 ( 28.5%) genotype: 1|1
    37,308 out of    146,618 ( 25.4%) genotype: 0|1
    36,818 out of    146,618 ( 25.1%) genotype: 1|0
    15,592 out of    146,618 ( 10.6%) genotype: 1|2
    15,159 out of    146,618 ( 10.3%) genotype: 2|1
--------------
   146,618 out of    146,618 (100.0%) TOTAL variants
    58,275 out of    146,618 ( 39.7%) DEL variants
    57,592 out of    146,618 ( 39.3%) INS variants
    10,844 out of    146,618 (  7.4%) multiallelic DEL variants
    10,284 out of    146,618 (  7.0%) multiallelic INS variants
     9,623 out of    146,618 (  6.6%) mixed multiallelic INS/DEL variants
--------------
   177,369 out of    177,369 (100.0%) TOTAL alleles
    89,586 out of    177,369 ( 50.5%) DEL alleles
    87,783 out of    177,369 ( 49.5%) INS alleles
VCF stats for the output vcf -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --  step3.STRs.lifted_to_chm13v2.vcf.gz
    84,521 TOTAL variants
    95,005 TOTAL alleles (1.12 alleles per variant)
--------------
    35,907 out of     84,521 ( 42.5%) genotype: 1|0
    20,108 out of     84,521 ( 23.8%) genotype: 0|1
    18,022 out of     84,521 ( 21.3%) genotype: 1|1
     5,373 out of     84,521 (  6.4%) genotype: 1|2
     5,111 out of     84,521 (  6.0%) genotype: 2|1
--------------
    84,521 out of     84,521 (100.0%) TOTAL variants
    57,086 out of     84,521 ( 67.5%) INS variants
    16,951 out of     84,521 ( 20.1%) DEL variants
    10,270 out of     84,521 ( 12.2%) multiallelic INS variants
       147 out of     84,521 (  0.2%) mixed multiallelic INS/DEL variants
        67 out of     84,521 (  0.1%) multiallelic DEL variants
--------------
    95,005 out of     95,005 (100.0%) TOTAL alleles
    77,773 out of     95,005 ( 81.9%) INS alleles
    17,232 out of     95,005 ( 18.1%) DEL alleles
VCF stats for  -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --  step3.lifted_to_chm13v2_rejected.vcf.gz
    62,097 TOTAL variants
    82,364 TOTAL alleles (1.33 alleles per variant)
--------------
    23,719 out of     62,097 ( 38.2%) genotype: 1|1
    17,200 out of     62,097 ( 27.7%) genotype: 0|1
    10,219 out of     62,097 ( 16.5%) genotype: 1|2
    10,048 out of     62,097 ( 16.2%) genotype: 2|1
       911 out of     62,097 (  1.5%) genotype: 1|0
--------------
    62,097 out of     62,097 (100.0%) TOTAL variants
    41,324 out of     62,097 ( 66.5%) DEL variants
    10,777 out of     62,097 ( 17.4%) multiallelic DEL variants
     9,476 out of     62,097 ( 15.3%) mixed multiallelic INS/DEL variants
       506 out of     62,097 (  0.8%) INS variants
        14 out of     62,097 (  0.0%) multiallelic INS variants
--------------
    82,364 out of     82,364 (100.0%) TOTAL alleles
    72,354 out of     82,364 ( 87.8%) DEL alleles
    10,010 out of     82,364 ( 12.2%) INS alleles
Reasons for Liftover failure:
      2 CannotLiftOver
  60590 IndelStraddlesMultipleIntevals
    623 MismatchedRefAllele
    882 NoTarget
===============
STEP #4: Filter out variants that are true homozygous alt or multi-allelic after liftover since this means neither allele matches the T2T reference (chm13v2.0)
         INPUT: step3.STRs.lifted_to_chm13v2.vcf.gz        84521 variants
+ python3 -u scripts/filter_out_discordant_variants_after_liftover.py --reference-fasta ./ref/chm13v2.0.fa step3.STRs.lifted_to_chm13v2.vcf.gz step4.STRs.found_in_chm13v2.vcf.gz
Wrote 84521 out of 84560 (100.0%) lines to step4.STRs.found_in_chm13v2.vcf.gz
Stats: 
     84521 (100.0%) total variants
     56015 ( 66.3%) kept variants: heterozygous reference genotype
     28211 ( 33.4%) kept variants: insertion matches the adjacent reference sequence
       111 (  0.1%) filtered out variants: DEL 1/1
        69 (  0.1%) filtered out variants: INS 1/1
        50 (  0.1%) filtered out variants: DEL 1/2
        24 (  0.0%) filtered out variants: INS 1/2
        17 (  0.0%) filtered out variants: INS 2/1
        17 (  0.0%) filtered out variants: DEL 2/1
         6 (  0.0%) filtered out variants: DEL,INS 2/1
         1 (  0.0%) filtered out variants: DEL,INS 1/2
+ set +x
         OUTPUT: step4.STRs.found_in_chm13v2.vcf.gz         84226 variants
VCF stats for the input vcf -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --  step3.STRs.lifted_to_chm13v2.vcf.gz
    84,521 TOTAL variants
    95,005 TOTAL alleles (1.12 alleles per variant)
--------------
    35,907 out of     84,521 ( 42.5%) genotype: 1|0
    20,108 out of     84,521 ( 23.8%) genotype: 0|1
    18,022 out of     84,521 ( 21.3%) genotype: 1|1
     5,373 out of     84,521 (  6.4%) genotype: 1|2
     5,111 out of     84,521 (  6.0%) genotype: 2|1
--------------
    84,521 out of     84,521 (100.0%) TOTAL variants
    57,086 out of     84,521 ( 67.5%) INS variants
    16,951 out of     84,521 ( 20.1%) DEL variants
    10,270 out of     84,521 ( 12.2%) multiallelic INS variants
       147 out of     84,521 (  0.2%) mixed multiallelic INS/DEL variants
        67 out of     84,521 (  0.1%) multiallelic DEL variants
--------------
    95,005 out of     95,005 (100.0%) TOTAL alleles
    77,773 out of     95,005 ( 81.9%) INS alleles
    17,232 out of     95,005 ( 18.1%) DEL alleles
VCF stats for the output vcf -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --  step4.STRs.found_in_chm13v2.vcf.gz
    84,226 TOTAL variants
    94,595 TOTAL alleles (1.12 alleles per variant)
--------------
    35,907 out of     84,226 ( 42.6%) genotype: 1|0
    20,108 out of     84,226 ( 23.9%) genotype: 0|1
    17,842 out of     84,226 ( 21.2%) genotype: 1|1
     5,298 out of     84,226 (  6.3%) genotype: 1|2
     5,071 out of     84,226 (  6.0%) genotype: 2|1
--------------
    84,226 out of     84,226 (100.0%) TOTAL variants
    57,017 out of     84,226 ( 67.7%) INS variants
    16,840 out of     84,226 ( 20.0%) DEL variants
    10,229 out of     84,226 ( 12.1%) multiallelic INS variants
       140 out of     84,226 (  0.2%) mixed multiallelic INS/DEL variants
--------------
    94,595 out of     94,595 (100.0%) TOTAL alleles
    77,615 out of     94,595 ( 82.0%) INS alleles
    16,980 out of     94,595 ( 18.0%) DEL alleles
===============
STEP #5: Liftover the truth variants that passed all checks back to hg38
         INPUT: step4.STRs.found_in_chm13v2.vcf.gz        84226 variants
+ gatk --java-options -Xmx7g LiftoverVcf -R ./ref/hg38.fa -C ./ref/chm13v2-hg38.chain -I step4.STRs.found_in_chm13v2.vcf.gz -O step5.STRs.lifted_back_to_38.vcf.gz --REJECT step5.lifted_back_to_38_rejected.vcf.gz --VALIDATION_STRINGENCY LENIENT --RECOVER_SWAPPED_REF_ALT --WARN_ON_MISSING_CONTIG --LIFTOVER_MIN_MATCH 0.00001 --WRITE_ORIGINAL_POSITION --WRITE_ORIGINAL_ALLELES --ALLOW_MISSING_FIELDS_IN_HEADER
21:48:40.140 INFO  NativeLibraryLoader - Loading libgkl_compression.dylib from jar:file:/Users/weisburd/bin/gatk-package-4.2.0.0-local.jar!/com/intel/gkl/native/libgkl_compression.dylib
[Sat Nov 26 21:48:40 EST 2022] LiftoverVcf --INPUT step4.STRs.found_in_chm13v2.vcf.gz --OUTPUT step5.STRs.lifted_back_to_38.vcf.gz --CHAIN ./ref/chm13v2-hg38.chain --REJECT step5.lifted_back_to_38_rejected.vcf.gz --WARN_ON_MISSING_CONTIG true --WRITE_ORIGINAL_POSITION true --WRITE_ORIGINAL_ALLELES true --LIFTOVER_MIN_MATCH 1.0E-5 --ALLOW_MISSING_FIELDS_IN_HEADER true --RECOVER_SWAPPED_REF_ALT true --VALIDATION_STRINGENCY LENIENT --REFERENCE_SEQUENCE ./ref/hg38.fa --LOG_FAILED_INTERVALS true --TAGS_TO_REVERSE AF --TAGS_TO_DROP MAX_AF --DISABLE_SORT false --VERBOSITY INFO --QUIET false --COMPRESSION_LEVEL 2 --MAX_RECORDS_IN_RAM 500000 --CREATE_INDEX false --CREATE_MD5_FILE false --GA4GH_CLIENT_SECRETS client_secrets.json --help false --version false --showHidden false --USE_JDK_DEFLATER false --USE_JDK_INFLATER false
[Sat Nov 26 21:48:40 EST 2022] Executing as weisburd@wm103-772 on Mac OS X 10.16 x86_64; OpenJDK 64-Bit Server VM 1.8.0_322-b06; Deflater: Intel; Inflater: Intel; Provider GCS is available; Picard version: Version:4.2.0.0
INFO	2022-11-26 21:48:40	LiftoverVcf	Loading up the target reference genome.
INFO	2022-11-26 21:48:49	LiftoverVcf	Lifting variants over and sorting (not yet writing the output file.)
INFO	2022-11-26 21:48:52	LiftoverVcf	Processed 84226 variants.
INFO	2022-11-26 21:48:52	LiftoverVcf	43 variants failed to liftover.
INFO	2022-11-26 21:48:52	LiftoverVcf	0 variants lifted over but had mismatching reference alleles after lift over.
INFO	2022-11-26 21:48:52	LiftoverVcf	0.0511% of variants were not successfully lifted over and written to the output.
INFO	2022-11-26 21:48:52	LiftoverVcf	liftover success by source contig:
INFO	2022-11-26 21:48:52	LiftoverVcf	chr1: 6453 / 6467 (99.7835%)
INFO	2022-11-26 21:48:52	LiftoverVcf	chr10: 3943 / 3943 (100.0000%)
INFO	2022-11-26 21:48:52	LiftoverVcf	chr11: 3773 / 3777 (99.8941%)
INFO	2022-11-26 21:48:52	LiftoverVcf	chr12: 4005 / 4005 (100.0000%)
INFO	2022-11-26 21:48:52	LiftoverVcf	chr13: 3001 / 3001 (100.0000%)
INFO	2022-11-26 21:48:52	LiftoverVcf	chr14: 2669 / 2669 (100.0000%)
INFO	2022-11-26 21:48:52	LiftoverVcf	chr15: 2308 / 2308 (100.0000%)
INFO	2022-11-26 21:48:52	LiftoverVcf	chr16: 2426 / 2430 (99.8354%)
INFO	2022-11-26 21:48:52	LiftoverVcf	chr17: 2426 / 2426 (100.0000%)
INFO	2022-11-26 21:48:52	LiftoverVcf	chr18: 2311 / 2311 (100.0000%)
INFO	2022-11-26 21:48:52	LiftoverVcf	chr19: 1916 / 1916 (100.0000%)
INFO	2022-11-26 21:48:52	LiftoverVcf	chr2: 6862 / 6862 (100.0000%)
INFO	2022-11-26 21:48:52	LiftoverVcf	chr20: 1965 / 1965 (100.0000%)
INFO	2022-11-26 21:48:52	LiftoverVcf	chr21: 1162 / 1162 (100.0000%)
INFO	2022-11-26 21:48:52	LiftoverVcf	chr22: 1111 / 1111 (100.0000%)
INFO	2022-11-26 21:48:52	LiftoverVcf	chr3: 5744 / 5747 (99.9478%)
INFO	2022-11-26 21:48:52	LiftoverVcf	chr4: 5548 / 5548 (100.0000%)
INFO	2022-11-26 21:48:52	LiftoverVcf	chr5: 5269 / 5269 (100.0000%)
INFO	2022-11-26 21:48:52	LiftoverVcf	chr6: 5029 / 5029 (100.0000%)
INFO	2022-11-26 21:48:52	LiftoverVcf	chr7: 4523 / 4523 (100.0000%)
INFO	2022-11-26 21:48:52	LiftoverVcf	chr8: 4189 / 4204 (99.6432%)
INFO	2022-11-26 21:48:52	LiftoverVcf	chr9: 3332 / 3332 (100.0000%)
INFO	2022-11-26 21:48:52	LiftoverVcf	chrX: 4218 / 4221 (99.9289%)
INFO	2022-11-26 21:48:52	LiftoverVcf	lifted variants by target contig:
INFO	2022-11-26 21:48:52	LiftoverVcf	chr1: 6453
INFO	2022-11-26 21:48:52	LiftoverVcf	chr10: 3943
INFO	2022-11-26 21:48:52	LiftoverVcf	chr11: 3773
INFO	2022-11-26 21:48:52	LiftoverVcf	chr12: 4005
INFO	2022-11-26 21:48:52	LiftoverVcf	chr13: 3001
INFO	2022-11-26 21:48:52	LiftoverVcf	chr14: 2669
INFO	2022-11-26 21:48:52	LiftoverVcf	chr15: 2308
INFO	2022-11-26 21:48:52	LiftoverVcf	chr16: 2426
INFO	2022-11-26 21:48:52	LiftoverVcf	chr17: 2426
INFO	2022-11-26 21:48:52	LiftoverVcf	chr18: 2311
INFO	2022-11-26 21:48:52	LiftoverVcf	chr19: 1916
INFO	2022-11-26 21:48:52	LiftoverVcf	chr2: 6862
INFO	2022-11-26 21:48:52	LiftoverVcf	chr20: 1965
INFO	2022-11-26 21:48:52	LiftoverVcf	chr21: 1162
INFO	2022-11-26 21:48:52	LiftoverVcf	chr22: 1111
INFO	2022-11-26 21:48:52	LiftoverVcf	chr3: 5744
INFO	2022-11-26 21:48:52	LiftoverVcf	chr4: 5548
INFO	2022-11-26 21:48:52	LiftoverVcf	chr5: 5269
INFO	2022-11-26 21:48:52	LiftoverVcf	chr6: 5029
INFO	2022-11-26 21:48:52	LiftoverVcf	chr7: 4523
INFO	2022-11-26 21:48:52	LiftoverVcf	chr8: 4189
INFO	2022-11-26 21:48:52	LiftoverVcf	chr9: 3332
INFO	2022-11-26 21:48:52	LiftoverVcf	chrX: 4218
INFO	2022-11-26 21:48:52	LiftoverVcf	0 variants were lifted by swapping REF/ALT alleles.
INFO	2022-11-26 21:48:52	LiftoverVcf	Writing out sorted records to final VCF.
[Sat Nov 26 21:48:53 EST 2022] picard.vcf.LiftoverVcf done. Elapsed time: 0.23 minutes.
Runtime.totalMemory()=4951375872
Tool returned:
0
Using GATK jar /Users/weisburd/bin/gatk-package-4.2.0.0-local.jar
Running:
    java -Dsamjdk.use_async_io_read_samtools=false -Dsamjdk.use_async_io_write_samtools=true -Dsamjdk.use_async_io_write_tribble=false -Dsamjdk.compression_level=2 -Xmx7g -jar /Users/weisburd/bin/gatk-package-4.2.0.0-local.jar LiftoverVcf -R ./ref/hg38.fa -C ./ref/chm13v2-hg38.chain -I step4.STRs.found_in_chm13v2.vcf.gz -O step5.STRs.lifted_back_to_38.vcf.gz --REJECT step5.lifted_back_to_38_rejected.vcf.gz --VALIDATION_STRINGENCY LENIENT --RECOVER_SWAPPED_REF_ALT --WARN_ON_MISSING_CONTIG --LIFTOVER_MIN_MATCH 0.00001 --WRITE_ORIGINAL_POSITION --WRITE_ORIGINAL_ALLELES --ALLOW_MISSING_FIELDS_IN_HEADER
+ set +x
         OUTPUT: step5.STRs.lifted_back_to_38.vcf.gz         84183 variants
VCF stats for the input vcf -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --  step4.STRs.found_in_chm13v2.vcf.gz
    84,226 TOTAL variants
    94,595 TOTAL alleles (1.12 alleles per variant)
--------------
    35,907 out of     84,226 ( 42.6%) genotype: 1|0
    20,108 out of     84,226 ( 23.9%) genotype: 0|1
    17,842 out of     84,226 ( 21.2%) genotype: 1|1
     5,298 out of     84,226 (  6.3%) genotype: 1|2
     5,071 out of     84,226 (  6.0%) genotype: 2|1
--------------
    84,226 out of     84,226 (100.0%) TOTAL variants
    57,017 out of     84,226 ( 67.7%) INS variants
    16,840 out of     84,226 ( 20.0%) DEL variants
    10,229 out of     84,226 ( 12.1%) multiallelic INS variants
       140 out of     84,226 (  0.2%) mixed multiallelic INS/DEL variants
--------------
    94,595 out of     94,595 (100.0%) TOTAL alleles
    77,615 out of     94,595 ( 82.0%) INS alleles
    16,980 out of     94,595 ( 18.0%) DEL alleles
VCF stats for the output vcf -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --  step5.STRs.lifted_back_to_38.vcf.gz
    84,183 TOTAL variants
    94,552 TOTAL alleles (1.12 alleles per variant)
--------------
    35,907 out of     84,183 ( 42.7%) genotype: 1|0
    20,065 out of     84,183 ( 23.8%) genotype: 0|1
    17,842 out of     84,183 ( 21.2%) genotype: 1|1
     5,298 out of     84,183 (  6.3%) genotype: 1|2
     5,071 out of     84,183 (  6.0%) genotype: 2|1
--------------
    84,183 out of     84,183 (100.0%) TOTAL variants
    56,974 out of     84,183 ( 67.7%) INS variants
    16,840 out of     84,183 ( 20.0%) DEL variants
    10,229 out of     84,183 ( 12.2%) multiallelic INS variants
       140 out of     84,183 (  0.2%) mixed multiallelic INS/DEL variants
--------------
    94,552 out of     94,552 (100.0%) TOTAL alleles
    77,572 out of     94,552 ( 82.0%) INS alleles
    16,980 out of     94,552 ( 18.0%) DEL alleles
VCF stats for  -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --  step5.lifted_back_to_38_rejected.vcf.gz
        43 TOTAL variants
        43 TOTAL alleles (1.00 alleles per variant)
--------------
        43 out of         43 (100.0%) genotype: 0|1
--------------
        43 out of         43 (100.0%) INS variants
        43 out of         43 (100.0%) TOTAL variants
--------------
        43 out of         43 (100.0%) INS alleles
        43 out of         43 (100.0%) TOTAL alleles
Reasons for Liftover failure:
     43 NoTarget
===============
STEP #6: Restore deletions that were dropped in the 1st liftover (hg38 => chm13v2.0) due to IndelStraddlesMultipleIntevals flag in picard LiftoverVcf. See https://github.com/broadinstitute/picard/blob/master/src/main/java/picard/vcf/LiftoverVcf.java#L424-L431 for more details on IndelStraddlesMultipleIntevals
         INPUT: step5.STRs.lifted_back_to_38.vcf.gz        84183 variants
+ gunzip -c step5.STRs.lifted_back_to_38.vcf.gz
+ gunzip -c step3.lifted_to_chm13v2_rejected.vcf.gz
+ grep -v '^#'
+ grep IndelStraddlesMultipleIntevals
+ awk '{ if ( length($4) > length($5) || index($5, ",") > 0) { print $0 } }'
+ gatk FixVcfHeader -I temp.vcf -O temp.fixed.vcf
21:48:58.648 INFO  NativeLibraryLoader - Loading libgkl_compression.dylib from jar:file:/Users/weisburd/bin/gatk-package-4.2.0.0-local.jar!/com/intel/gkl/native/libgkl_compression.dylib
[Sat Nov 26 21:48:58 EST 2022] FixVcfHeader --INPUT temp.vcf --OUTPUT temp.fixed.vcf --CHECK_FIRST_N_RECORDS -1 --ENFORCE_SAME_SAMPLES true --VERBOSITY INFO --QUIET false --VALIDATION_STRINGENCY STRICT --COMPRESSION_LEVEL 2 --MAX_RECORDS_IN_RAM 500000 --CREATE_INDEX false --CREATE_MD5_FILE false --GA4GH_CLIENT_SECRETS client_secrets.json --help false --version false --showHidden false --USE_JDK_DEFLATER false --USE_JDK_INFLATER false
[Sat Nov 26 21:48:58 EST 2022] Executing as weisburd@wm103-772 on Mac OS X 10.16 x86_64; OpenJDK 64-Bit Server VM 1.8.0_322-b06; Deflater: Intel; Inflater: Intel; Provider GCS is available; Picard version: Version:4.2.0.0
INFO	2022-11-26 21:48:58	FixVcfHeader	Reading in records to re-build the header.
INFO	2022-11-26 21:48:58	FixVcfHeader	Will add an INFO line with id: NumRepeats1
INFO	2022-11-26 21:48:58	FixVcfHeader	Will add an INFO line with id: NumRepeats2
INFO	2022-11-26 21:48:58	FixVcfHeader	Will add an INFO line with id: Motif
INFO	2022-11-26 21:48:59	FixVcfHeader	Will add an FILTER line with id: IndelStraddlesMultipleIntevals
INFO	2022-11-26 21:48:59	FixVcfHeader	VCF header re-built.
INFO	2022-11-26 21:48:59	FixVcfHeader	Writing the output VCF.
[Sat Nov 26 21:49:01 EST 2022] picard.vcf.FixVcfHeader done. Elapsed time: 0.04 minutes.
Runtime.totalMemory()=593494016
Tool returned:
0
Using GATK jar /Users/weisburd/bin/gatk-package-4.2.0.0-local.jar
Running:
    java -Dsamjdk.use_async_io_read_samtools=false -Dsamjdk.use_async_io_write_samtools=true -Dsamjdk.use_async_io_write_tribble=false -Dsamjdk.compression_level=2 -jar /Users/weisburd/bin/gatk-package-4.2.0.0-local.jar FixVcfHeader -I temp.vcf -O temp.fixed.vcf
+ gatk SortVcf -I temp.fixed.vcf -O step6.STRs.restored_dels_that_failed_liftover.vcf.gz
21:49:03.222 INFO  NativeLibraryLoader - Loading libgkl_compression.dylib from jar:file:/Users/weisburd/bin/gatk-package-4.2.0.0-local.jar!/com/intel/gkl/native/libgkl_compression.dylib
[Sat Nov 26 21:49:03 EST 2022] SortVcf --INPUT temp.fixed.vcf --OUTPUT step6.STRs.restored_dels_that_failed_liftover.vcf.gz --VERBOSITY INFO --QUIET false --VALIDATION_STRINGENCY STRICT --COMPRESSION_LEVEL 2 --MAX_RECORDS_IN_RAM 500000 --CREATE_INDEX true --CREATE_MD5_FILE false --GA4GH_CLIENT_SECRETS client_secrets.json --help false --version false --showHidden false --USE_JDK_DEFLATER false --USE_JDK_INFLATER false
[Sat Nov 26 21:49:03 EST 2022] Executing as weisburd@wm103-772 on Mac OS X 10.16 x86_64; OpenJDK 64-Bit Server VM 1.8.0_322-b06; Deflater: Intel; Inflater: Intel; Provider GCS is available; Picard version: Version:4.2.0.0
INFO	2022-11-26 21:49:03	SortVcf	Reading entries from input file 1
INFO	2022-11-26 21:49:03	SortVcf	read        25,000 records.  Elapsed time: 00:00:00s.  Time for last 25,000:    0s.  Last read position: chr15:63,134,812
INFO	2022-11-26 21:49:03	SortVcf	read        50,000 records.  Elapsed time: 00:00:00s.  Time for last 25,000:    0s.  Last read position: chr3:130,479,419
INFO	2022-11-26 21:49:03	SortVcf	read        75,000 records.  Elapsed time: 00:00:00s.  Time for last 25,000:    0s.  Last read position: chr8:90,968,657
INFO	2022-11-26 21:49:03	SortVcf	read       100,000 records.  Elapsed time: 00:00:00s.  Time for last 25,000:    0s.  Last read position: chr4:89,307,269
INFO	2022-11-26 21:49:04	SortVcf	read       125,000 records.  Elapsed time: 00:00:00s.  Time for last 25,000:    0s.  Last read position: chr12:64,684,013
INFO	2022-11-26 21:49:04	SortVcf	wrote        25,000 records.  Elapsed time: 00:00:00s.  Time for last 25,000:    0s.  Last read position: chr12:4,105,959
INFO	2022-11-26 21:49:05	SortVcf	wrote        50,000 records.  Elapsed time: 00:00:00s.  Time for last 25,000:    0s.  Last read position: chr17:3,519,904
INFO	2022-11-26 21:49:05	SortVcf	wrote        75,000 records.  Elapsed time: 00:00:00s.  Time for last 25,000:    0s.  Last read position: chr20:38,855,982
INFO	2022-11-26 21:49:05	SortVcf	wrote       100,000 records.  Elapsed time: 00:00:00s.  Time for last 25,000:    0s.  Last read position: chr5:6,278,480
INFO	2022-11-26 21:49:05	SortVcf	wrote       125,000 records.  Elapsed time: 00:00:00s.  Time for last 25,000:    0s.  Last read position: chr8:3,602,716
[Sat Nov 26 21:49:05 EST 2022] picard.vcf.SortVcf done. Elapsed time: 0.04 minutes.
Runtime.totalMemory()=832045056
Tool returned:
0
Using GATK jar /Users/weisburd/bin/gatk-package-4.2.0.0-local.jar
Running:
    java -Dsamjdk.use_async_io_read_samtools=false -Dsamjdk.use_async_io_write_samtools=true -Dsamjdk.use_async_io_write_tribble=false -Dsamjdk.compression_level=2 -jar /Users/weisburd/bin/gatk-package-4.2.0.0-local.jar SortVcf -I temp.fixed.vcf -O step6.STRs.restored_dels_that_failed_liftover.vcf.gz
+ rm temp.vcf temp.fixed.vcf temp.fixed.vcf.idx
+ set +x
         OUTPUT: step6.STRs.restored_dels_that_failed_liftover.vcf.gz         144773 variants
VCF stats for the input vcf -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --  step5.STRs.lifted_back_to_38.vcf.gz
    84,183 TOTAL variants
    94,552 TOTAL alleles (1.12 alleles per variant)
--------------
    35,907 out of     84,183 ( 42.7%) genotype: 1|0
    20,065 out of     84,183 ( 23.8%) genotype: 0|1
    17,842 out of     84,183 ( 21.2%) genotype: 1|1
     5,298 out of     84,183 (  6.3%) genotype: 1|2
     5,071 out of     84,183 (  6.0%) genotype: 2|1
--------------
    84,183 out of     84,183 (100.0%) TOTAL variants
    56,974 out of     84,183 ( 67.7%) INS variants
    16,840 out of     84,183 ( 20.0%) DEL variants
    10,229 out of     84,183 ( 12.2%) multiallelic INS variants
       140 out of     84,183 (  0.2%) mixed multiallelic INS/DEL variants
--------------
    94,552 out of     94,552 (100.0%) TOTAL alleles
    77,572 out of     94,552 ( 82.0%) INS alleles
    16,980 out of     94,552 ( 18.0%) DEL alleles
VCF stats for the output vcf -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --  step6.STRs.restored_dels_that_failed_liftover.vcf.gz
   144,773 TOTAL variants
   175,372 TOTAL alleles (1.21 alleles per variant)
--------------
    40,692 out of    144,773 ( 28.1%) genotype: 1|1
    37,133 out of    144,773 ( 25.6%) genotype: 0|1
    36,349 out of    144,773 ( 25.1%) genotype: 1|0
    15,500 out of    144,773 ( 10.7%) genotype: 1|2
    15,099 out of    144,773 ( 10.4%) genotype: 2|1
--------------
   144,773 out of    144,773 (100.0%) TOTAL variants
    57,200 out of    144,773 ( 39.5%) DEL variants
    56,974 out of    144,773 ( 39.4%) INS variants
    10,761 out of    144,773 (  7.4%) multiallelic DEL variants
    10,229 out of    144,773 (  7.1%) multiallelic INS variants
     9,609 out of    144,773 (  6.6%) mixed multiallelic INS/DEL variants
--------------
   175,372 out of    175,372 (100.0%) TOTAL alleles
    88,331 out of    175,372 ( 50.4%) DEL alleles
    87,041 out of    175,372 ( 49.6%) INS alleles
===============
STEP #7: Check VCF positions before vs. after liftover to confirm concordance.
         INPUT: step6.STRs.restored_dels_that_failed_liftover.vcf.gz        144773 variants
+ python3 -u scripts/check_vcf_concordance_before_vs_after_liftover.py -o step7.STRs.passed_liftover_checks.vcf.gz step2.STRs.vcf.gz step6.STRs.restored_dels_that_failed_liftover.vcf.gz
Parsed 146,618 variants from step2.STRs.vcf.gz
Parsed 144,773 variants from step6.STRs.restored_dels_that_failed_liftover.vcf.gz
Wrote 144,773 out of 146,618 (98.7%) variants to step7.STRs.passed_liftover_checks.vcf.gz
     0 variants had a different position after hg38 => T2T => hg38
+ set +x
         OUTPUT: step7.STRs.passed_liftover_checks.vcf.gz         144773 variants
VCF stats for the input vcf -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --  step6.STRs.restored_dels_that_failed_liftover.vcf.gz
   144,773 TOTAL variants
   175,372 TOTAL alleles (1.21 alleles per variant)
--------------
    40,692 out of    144,773 ( 28.1%) genotype: 1|1
    37,133 out of    144,773 ( 25.6%) genotype: 0|1
    36,349 out of    144,773 ( 25.1%) genotype: 1|0
    15,500 out of    144,773 ( 10.7%) genotype: 1|2
    15,099 out of    144,773 ( 10.4%) genotype: 2|1
--------------
   144,773 out of    144,773 (100.0%) TOTAL variants
    57,200 out of    144,773 ( 39.5%) DEL variants
    56,974 out of    144,773 ( 39.4%) INS variants
    10,761 out of    144,773 (  7.4%) multiallelic DEL variants
    10,229 out of    144,773 (  7.1%) multiallelic INS variants
     9,609 out of    144,773 (  6.6%) mixed multiallelic INS/DEL variants
--------------
   175,372 out of    175,372 (100.0%) TOTAL alleles
    88,331 out of    175,372 ( 50.4%) DEL alleles
    87,041 out of    175,372 ( 49.6%) INS alleles
VCF stats for the output vcf -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --  step7.STRs.passed_liftover_checks.vcf.gz
   144,773 TOTAL variants
   175,372 TOTAL alleles (1.21 alleles per variant)
--------------
    40,692 out of    144,773 ( 28.1%) genotype: 1|1
    37,133 out of    144,773 ( 25.6%) genotype: 0|1
    36,349 out of    144,773 ( 25.1%) genotype: 1|0
    15,500 out of    144,773 ( 10.7%) genotype: 1|2
    15,099 out of    144,773 ( 10.4%) genotype: 2|1
--------------
   144,773 out of    144,773 (100.0%) TOTAL variants
    57,200 out of    144,773 ( 39.5%) DEL variants
    56,974 out of    144,773 ( 39.4%) INS variants
    10,761 out of    144,773 (  7.4%) multiallelic DEL variants
    10,229 out of    144,773 (  7.1%) multiallelic INS variants
     9,609 out of    144,773 (  6.6%) mixed multiallelic INS/DEL variants
--------------
   175,372 out of    175,372 (100.0%) TOTAL alleles
    88,331 out of    175,372 ( 50.4%) DEL alleles
    87,041 out of    175,372 ( 49.6%) INS alleles
===============
step8: Print stats and compute overlap with other catalogs.
         INPUT: step7.STRs.passed_liftover_checks.vcf.gz        144773 variants
+ python3 -u -m str_analysis.filter_vcf_to_STR_variants -R ./ref/hg38.fa --write-bed-file --min-fraction-of-variant-covered-by-repeat 1 --min-str-length 9 --min-str-repeats 3 --output-prefix step7.filtered_STRs step7.STRs.passed_liftover_checks.vcf.gz
2022-11-26 21:49:40,185 INFO: --------------
2022-11-26 21:49:40,186 INFO:    175,372 out of    175,372 (100.0%) STR allele counts: TOTAL
2022-11-26 21:49:40,186 INFO:     88,331 out of    175,372 ( 50.4%) STR allele counts: DEL
2022-11-26 21:49:40,186 INFO:     87,041 out of    175,372 ( 49.6%) STR allele counts: INS
2022-11-26 21:49:40,186 INFO: --------------
2022-11-26 21:49:40,186 INFO:     93,094 out of    175,372 ( 53.1%) STR allele delta: 1 repeats
2022-11-26 21:49:40,186 INFO:     34,195 out of    175,372 ( 19.5%) STR allele delta: 2 repeats
2022-11-26 21:49:40,186 INFO:     17,282 out of    175,372 (  9.9%) STR allele delta: 3 repeats
2022-11-26 21:49:40,186 INFO:     10,110 out of    175,372 (  5.8%) STR allele delta: 4 repeats
2022-11-26 21:49:40,186 INFO:      6,441 out of    175,372 (  3.7%) STR allele delta: 5 repeats
2022-11-26 21:49:40,186 INFO:      5,276 out of    175,372 (  3.0%) STR allele delta: 9+ repeats
2022-11-26 21:49:40,186 INFO:      4,159 out of    175,372 (  2.4%) STR allele delta: 6 repeats
2022-11-26 21:49:40,186 INFO:      2,840 out of    175,372 (  1.6%) STR allele delta: 7 repeats
2022-11-26 21:49:40,186 INFO:      1,975 out of    175,372 (  1.1%) STR allele delta: 8 repeats
2022-11-26 21:49:40,186 INFO: --------------
2022-11-26 21:49:40,186 INFO:    104,153 out of    175,372 ( 59.4%) STR allele motif size: 2 bp
2022-11-26 21:49:40,186 INFO:     39,130 out of    175,372 ( 22.3%) STR allele motif size: 4 bp
2022-11-26 21:49:40,186 INFO:     14,638 out of    175,372 (  8.3%) STR allele motif size: 3 bp
2022-11-26 21:49:40,186 INFO:      9,479 out of    175,372 (  5.4%) STR allele motif size: 5 bp
2022-11-26 21:49:40,186 INFO:      4,155 out of    175,372 (  2.4%) STR allele motif size: 9+ bp
2022-11-26 21:49:40,186 INFO:      2,561 out of    175,372 (  1.5%) STR allele motif size: 6 bp
2022-11-26 21:49:40,186 INFO:        720 out of    175,372 (  0.4%) STR allele motif size: 7 bp
2022-11-26 21:49:40,186 INFO:        536 out of    175,372 (  0.3%) STR allele motif size: 8 bp
2022-11-26 21:49:40,186 INFO: --------------
2022-11-26 21:49:40,187 INFO:    175,372 out of    175,372 (100.0%) STR allele purity: perfect repeats
2022-11-26 21:49:40,187 INFO: --------------
2022-11-26 21:49:40,187 INFO:    174,756 out of    175,372 ( 99.6%) STR allele reference repeats: with right matching ref. repeat
2022-11-26 21:49:40,187 INFO:        615 out of    175,372 (  0.4%) STR allele reference repeats: with no matching ref. repeat
2022-11-26 21:49:40,187 INFO:          1 out of    175,372 (  0.0%) STR allele reference repeats: with both left and right matching ref. repeat
2022-11-26 21:49:40,187 INFO: --------------
2022-11-26 21:49:40,187 INFO:    170,237 out of    175,372 ( 97.1%) STR allele size: 0-25bp
2022-11-26 21:49:40,187 INFO:      3,897 out of    175,372 (  2.2%) STR allele size: 25-50bp
2022-11-26 21:49:40,187 INFO:        597 out of    175,372 (  0.3%) STR allele size: 50-75bp
2022-11-26 21:49:40,187 INFO:        226 out of    175,372 (  0.1%) STR allele size: 75-100bp
2022-11-26 21:49:40,187 INFO:        124 out of    175,372 (  0.1%) STR allele size: 100-125bp
2022-11-26 21:49:40,187 INFO:         77 out of    175,372 (  0.0%) STR allele size: 125-150bp
2022-11-26 21:49:40,187 INFO:         48 out of    175,372 (  0.0%) STR allele size: 150-175bp
2022-11-26 21:49:40,187 INFO:         34 out of    175,372 (  0.0%) STR allele size: 175-200bp
2022-11-26 21:49:40,187 INFO:         26 out of    175,372 (  0.0%) STR allele size: 200-225bp
2022-11-26 21:49:40,187 INFO:         25 out of    175,372 (  0.0%) STR allele size: 225-250bp
2022-11-26 21:49:40,187 INFO:         16 out of    175,372 (  0.0%) STR allele size: 250-275bp
2022-11-26 21:49:40,187 INFO:         12 out of    175,372 (  0.0%) STR allele size: 500+bp
2022-11-26 21:49:40,187 INFO:         11 out of    175,372 (  0.0%) STR allele size: 275-300bp
2022-11-26 21:49:40,187 INFO:          9 out of    175,372 (  0.0%) STR allele size: 425-450bp
2022-11-26 21:49:40,187 INFO:          8 out of    175,372 (  0.0%) STR allele size: 350-375bp
2022-11-26 21:49:40,188 INFO:          7 out of    175,372 (  0.0%) STR allele size: 375-400bp
2022-11-26 21:49:40,188 INFO:          6 out of    175,372 (  0.0%) STR allele size: 325-350bp
2022-11-26 21:49:40,188 INFO:          4 out of    175,372 (  0.0%) STR allele size: 450-475bp
2022-11-26 21:49:40,188 INFO:          3 out of    175,372 (  0.0%) STR allele size: 300-325bp
2022-11-26 21:49:40,188 INFO:          3 out of    175,372 (  0.0%) STR allele size: 475-500bp
2022-11-26 21:49:40,188 INFO:          2 out of    175,372 (  0.0%) STR allele size: 400-425bp
2022-11-26 21:49:40,188 INFO: --------------
2022-11-26 21:49:40,188 INFO:     93,094 out of    175,372 ( 53.1%) STR allele source: found by NoRepeatFoundInVariantBases
2022-11-26 21:49:40,188 INFO:     82,278 out of    175,372 ( 46.9%) STR allele source: found by BruteForce
2022-11-26 21:49:40,188 INFO: --------------
2022-11-26 21:49:40,188 INFO:    144,773 out of    144,773 (100.0%) STR variant counts: TOTAL
2022-11-26 21:49:40,188 INFO:     30,599 out of    144,773 ( 21.1%) STR variant counts: multi-allelic
Finished writing to  step7.filtered_STRs.variants.tsv
Finished writing to  step7.filtered_STRs.alleles.tsv
Wrote 144773 to step7.filtered_STRs.variants.bed.gz
+ suffix=with_overlap_columns
+ wait
+ python3 -u scripts/compute_overlap_with_other_catalogs.py step7.filtered_STRs.variants.tsv.gz step7.filtered_STRs.variants.with_overlap_columns.tsv.gz
+ python3 -u scripts/compute_overlap_with_other_catalogs.py step7.filtered_STRs.alleles.tsv.gz step7.filtered_STRs.alleles.with_overlap_columns.tsv.gz
Parsed    174,300 intervals from IlluminaSTRCatalog                       ./ref/other/illumina_variant_catalog.sorted.bed.gz
Parsed    174,300 intervals from IlluminaSTRCatalog                       ./ref/other/illumina_variant_catalog.sorted.bed.gz
Parsed  1,340,266 intervals from GangSTRCatalog17                         ./ref/other/hg38_ver17.fixed.bed.gz
Parsed  1,340,266 intervals from GangSTRCatalog17                         ./ref/other/hg38_ver17.fixed.bed.gz
Parsed    832,380 intervals from GangSTRCatalog13                         ./ref/other/hg38_ver13.fixed.bed.gz
Parsed         60 intervals from KnownDiseaseAssociatedSTRs               ./ref/other/known_disease_associated_STR_loci.GRCh38.bed.gz
Parsed    832,380 intervals from GangSTRCatalog13                         ./ref/other/hg38_ver13.fixed.bed.gz
Parsed         60 intervals from KnownDiseaseAssociatedSTRs               ./ref/other/known_disease_associated_STR_loci.GRCh38.bed.gz
Parsed    702,486 intervals from TRFPureRepeats15bp                       ./ref/other/repeat_specs_GRCh38_without_mismatches.sorted.trimmed.at_least_15bp.bed.gz
Parsed    702,486 intervals from TRFPureRepeats15bp                       ./ref/other/repeat_specs_GRCh38_without_mismatches.sorted.trimmed.at_least_15bp.bed.gz
Parsed  1,343,313 intervals from TRFPureRepeats12bp                       ./ref/other/repeat_specs_GRCh38_without_mismatches.sorted.trimmed.at_least_12bp.bed.gz
Parsed  1,343,313 intervals from TRFPureRepeats12bp                       ./ref/other/repeat_specs_GRCh38_without_mismatches.sorted.trimmed.at_least_12bp.bed.gz
Parsed  2,805,842 intervals from TRFPureRepeats9bp                        ./ref/other/repeat_specs_GRCh38_without_mismatches.sorted.trimmed.at_least_9bp.bed.gz
Parsed  2,805,842 intervals from TRFPureRepeats9bp                        ./ref/other/repeat_specs_GRCh38_without_mismatches.sorted.trimmed.at_least_9bp.bed.gz
Parsed  4,722,859 intervals from TRFPureRepeats6bp                        ./ref/other/repeat_specs_GRCh38_without_mismatches.sorted.trimmed.at_least_6bp.bed.gz
Parsed  4,722,859 intervals from TRFPureRepeats6bp                        ./ref/other/repeat_specs_GRCh38_without_mismatches.sorted.trimmed.at_least_6bp.bed.gz
Parsed     64,222 intervals from SegDupIntervals                          ./ref/other/GRCh38GenomicSuperDup.without_decoys.sorted.bed.gz
Processing rows from step7.filtered_STRs.variants.tsv.gz
Parsed     64,222 intervals from SegDupIntervals                          ./ref/other/GRCh38GenomicSuperDup.without_decoys.sorted.bed.gz
Processing rows from step7.filtered_STRs.alleles.tsv.gz
Wrote 144,773 rows to the output tsv: step7.filtered_STRs.variants.with_overlap_columns.tsv.gz
GangSTRCatalog13              :     63,129 out of    144,773 ( 43.6%) truth set loci, and out of    832,380 (  7.6%) GangSTRCatalog13 loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif
GangSTRCatalog13              :        660 out of    144,773 (  0.5%) truth set loci, and out of    832,380 (  0.1%) GangSTRCatalog13 loci:     STR locus is contained within truth set STR locus             and has same motif after normalization
GangSTRCatalog13              :          7 out of    144,773 (  0.0%) truth set loci, and out of    832,380 (  0.0%) GangSTRCatalog13 loci:     STR locus is contained within truth set STR locus             and has different motif
GangSTRCatalog13              :         14 out of    144,773 (  0.0%) truth set loci, and out of    832,380 (  0.0%) GangSTRCatalog13 loci:     STR locus contains truth set STR locus                        and has different motif
GangSTRCatalog13              :          1 out of    144,773 (  0.0%) truth set loci, and out of    832,380 (  0.0%) GangSTRCatalog13 loci:     STR locus contains truth set STR locus                        and has same motif
GangSTRCatalog13              :        925 out of    144,773 (  0.6%) truth set loci, and out of    832,380 (  0.1%) GangSTRCatalog13 loci:     STR loci overlap                                              and has same motif after normalization
GangSTRCatalog13              :        638 out of    144,773 (  0.4%) truth set loci, and out of    832,380 (  0.1%) GangSTRCatalog13 loci:     STR loci overlap                                              and has different motif
GangSTRCatalog13              :          2 out of    144,773 (  0.0%) truth set loci, and out of    832,380 (  0.0%) GangSTRCatalog13 loci:     STR loci overlap                                              and has same motif
GangSTRCatalog13              :     79,397 out of    144,773 ( 54.8%) truth set loci:     no overlap                                                  
GangSTRCatalog17              :     80,981 out of    144,773 ( 55.9%) truth set loci, and out of  1,340,266 (  6.0%) GangSTRCatalog17 loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif
GangSTRCatalog17              :        989 out of    144,773 (  0.7%) truth set loci, and out of  1,340,266 (  0.1%) GangSTRCatalog17 loci:     STR locus is contained within truth set STR locus             and has same motif after normalization
GangSTRCatalog17              :         52 out of    144,773 (  0.0%) truth set loci, and out of  1,340,266 (  0.0%) GangSTRCatalog17 loci:     STR locus is contained within truth set STR locus             and has different motif
GangSTRCatalog17              :         36 out of    144,773 (  0.0%) truth set loci, and out of  1,340,266 (  0.0%) GangSTRCatalog17 loci:     STR locus contains truth set STR locus                        and has different motif
GangSTRCatalog17              :          1 out of    144,773 (  0.0%) truth set loci, and out of  1,340,266 (  0.0%) GangSTRCatalog17 loci:     STR locus contains truth set STR locus                        and has same motif
GangSTRCatalog17              :      1,925 out of    144,773 (  1.3%) truth set loci, and out of  1,340,266 (  0.1%) GangSTRCatalog17 loci:     STR loci overlap                                              and has different motif
GangSTRCatalog17              :      1,324 out of    144,773 (  0.9%) truth set loci, and out of  1,340,266 (  0.1%) GangSTRCatalog17 loci:     STR loci overlap                                              and has same motif after normalization
GangSTRCatalog17              :          3 out of    144,773 (  0.0%) truth set loci, and out of  1,340,266 (  0.0%) GangSTRCatalog17 loci:     STR loci overlap                                              and has same motif
GangSTRCatalog17              :     59,462 out of    144,773 ( 41.1%) truth set loci:     no overlap                                                  
IlluminaSTRCatalog            :     86,868 out of    144,773 ( 60.0%) truth set loci, and out of    174,300 ( 49.8%) IlluminaSTRCatalog loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif
IlluminaSTRCatalog            :        887 out of    144,773 (  0.6%) truth set loci, and out of    174,300 (  0.5%) IlluminaSTRCatalog loci:     STR locus is contained within truth set STR locus             and has same motif
IlluminaSTRCatalog            :         32 out of    144,773 (  0.0%) truth set loci, and out of    174,300 (  0.0%) IlluminaSTRCatalog loci:     STR locus is contained within truth set STR locus             and has same motif after normalization
IlluminaSTRCatalog            :         25 out of    144,773 (  0.0%) truth set loci, and out of    174,300 (  0.0%) IlluminaSTRCatalog loci:     STR locus is contained within truth set STR locus             and has different motif
IlluminaSTRCatalog            :      3,328 out of    144,773 (  2.3%) truth set loci, and out of    174,300 (  1.9%) IlluminaSTRCatalog loci:     STR locus contains truth set STR locus                        and has same motif
IlluminaSTRCatalog            :         88 out of    144,773 (  0.1%) truth set loci, and out of    174,300 (  0.1%) IlluminaSTRCatalog loci:     STR locus contains truth set STR locus                        and has same motif after normalization
IlluminaSTRCatalog            :         24 out of    144,773 (  0.0%) truth set loci, and out of    174,300 (  0.0%) IlluminaSTRCatalog loci:     STR locus contains truth set STR locus                        and has different motif
IlluminaSTRCatalog            :        180 out of    144,773 (  0.1%) truth set loci, and out of    174,300 (  0.1%) IlluminaSTRCatalog loci:     STR loci overlap                                              and has different motif
IlluminaSTRCatalog            :        151 out of    144,773 (  0.1%) truth set loci, and out of    174,300 (  0.1%) IlluminaSTRCatalog loci:     STR loci overlap                                              and has same motif after normalization
IlluminaSTRCatalog            :         53 out of    144,773 (  0.0%) truth set loci, and out of    174,300 (  0.0%) IlluminaSTRCatalog loci:     STR loci overlap                                              and has same motif
IlluminaSTRCatalog            :     53,137 out of    144,773 ( 36.7%) truth set loci:     no overlap                                                  
KnownDiseaseAssociatedSTRs    :         10 out of    144,773 (  0.0%) truth set loci, and out of         60 ( 16.7%) KnownDiseaseAssociatedSTRs loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif
KnownDiseaseAssociatedSTRs    :          3 out of    144,773 (  0.0%) truth set loci, and out of         60 (  5.0%) KnownDiseaseAssociatedSTRs loci:     STR locus is contained within truth set STR locus             and has same motif after normalization
KnownDiseaseAssociatedSTRs    :          4 out of    144,773 (  0.0%) truth set loci, and out of         60 (  6.7%) KnownDiseaseAssociatedSTRs loci:     STR locus contains truth set STR locus                        and has same motif
KnownDiseaseAssociatedSTRs    :          2 out of    144,773 (  0.0%) truth set loci, and out of         60 (  3.3%) KnownDiseaseAssociatedSTRs loci:     STR locus contains truth set STR locus                        and has same motif after normalization
KnownDiseaseAssociatedSTRs    :          3 out of    144,773 (  0.0%) truth set loci, and out of         60 (  5.0%) KnownDiseaseAssociatedSTRs loci:     STR loci overlap                                              and has same motif after normalization
KnownDiseaseAssociatedSTRs    :          1 out of    144,773 (  0.0%) truth set loci, and out of         60 (  1.7%) KnownDiseaseAssociatedSTRs loci:     STR loci overlap                                              and has different motif
KnownDiseaseAssociatedSTRs    :    144,750 out of    144,773 (100.0%) truth set loci:     no overlap                                                  
SegDupIntervals               :      3,093 out of    144,773 (  2.1%) truth set loci, and out of     64,222 (  4.8%) SegDupIntervals loci:     interval contains truth set STR locus                       
SegDupIntervals               :         28 out of    144,773 (  0.0%) truth set loci, and out of     64,222 (  0.0%) SegDupIntervals loci:     interval overlaps truth set STR locus                       
SegDupIntervals               :    141,652 out of    144,773 ( 97.8%) truth set loci:     no overlap                                                  
TRFPureRepeats12bp            :    131,762 out of    144,773 ( 91.0%) truth set loci, and out of  1,343,313 (  9.8%) TRFPureRepeats12bp loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif
TRFPureRepeats12bp            :        110 out of    144,773 (  0.1%) truth set loci, and out of  1,343,313 (  0.0%) TRFPureRepeats12bp loci:     STR locus is contained within truth set STR locus             and has different motif
TRFPureRepeats12bp            :          3 out of    144,773 (  0.0%) truth set loci, and out of  1,343,313 (  0.0%) TRFPureRepeats12bp loci:     STR locus is contained within truth set STR locus             and has same motif after normalization
TRFPureRepeats12bp            :          1 out of    144,773 (  0.0%) truth set loci, and out of  1,343,313 (  0.0%) TRFPureRepeats12bp loci:     STR locus is contained within truth set STR locus             and has same motif
TRFPureRepeats12bp            :        317 out of    144,773 (  0.2%) truth set loci, and out of  1,343,313 (  0.0%) TRFPureRepeats12bp loci:     STR locus contains truth set STR locus                        and has different motif
TRFPureRepeats12bp            :          6 out of    144,773 (  0.0%) truth set loci, and out of  1,343,313 (  0.0%) TRFPureRepeats12bp loci:     STR locus contains truth set STR locus                        and has same motif
TRFPureRepeats12bp            :      1,036 out of    144,773 (  0.7%) truth set loci, and out of  1,343,313 (  0.1%) TRFPureRepeats12bp loci:     STR loci overlap                                              and has different motif
TRFPureRepeats12bp            :         46 out of    144,773 (  0.0%) truth set loci, and out of  1,343,313 (  0.0%) TRFPureRepeats12bp loci:     STR loci overlap                                              and has same motif after normalization
TRFPureRepeats12bp            :         18 out of    144,773 (  0.0%) truth set loci, and out of  1,343,313 (  0.0%) TRFPureRepeats12bp loci:     STR loci overlap                                              and has same motif
TRFPureRepeats12bp            :     11,474 out of    144,773 (  7.9%) truth set loci:     no overlap                                                  
TRFPureRepeats15bp            :    120,057 out of    144,773 ( 82.9%) truth set loci, and out of    702,486 ( 17.1%) TRFPureRepeats15bp loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif
TRFPureRepeats15bp            :         58 out of    144,773 (  0.0%) truth set loci, and out of    702,486 (  0.0%) TRFPureRepeats15bp loci:     STR locus is contained within truth set STR locus             and has different motif
TRFPureRepeats15bp            :          3 out of    144,773 (  0.0%) truth set loci, and out of    702,486 (  0.0%) TRFPureRepeats15bp loci:     STR locus is contained within truth set STR locus             and has same motif after normalization
TRFPureRepeats15bp            :          1 out of    144,773 (  0.0%) truth set loci, and out of    702,486 (  0.0%) TRFPureRepeats15bp loci:     STR locus is contained within truth set STR locus             and has same motif
TRFPureRepeats15bp            :        406 out of    144,773 (  0.3%) truth set loci, and out of    702,486 (  0.1%) TRFPureRepeats15bp loci:     STR locus contains truth set STR locus                        and has different motif
TRFPureRepeats15bp            :          6 out of    144,773 (  0.0%) truth set loci, and out of    702,486 (  0.0%) TRFPureRepeats15bp loci:     STR locus contains truth set STR locus                        and has same motif
TRFPureRepeats15bp            :      1,358 out of    144,773 (  0.9%) truth set loci, and out of    702,486 (  0.2%) TRFPureRepeats15bp loci:     STR loci overlap                                              and has different motif
TRFPureRepeats15bp            :         40 out of    144,773 (  0.0%) truth set loci, and out of    702,486 (  0.0%) TRFPureRepeats15bp loci:     STR loci overlap                                              and has same motif after normalization
TRFPureRepeats15bp            :         14 out of    144,773 (  0.0%) truth set loci, and out of    702,486 (  0.0%) TRFPureRepeats15bp loci:     STR loci overlap                                              and has same motif
TRFPureRepeats15bp            :     22,830 out of    144,773 ( 15.8%) truth set loci:     no overlap                                                  
TRFPureRepeats6bp             :    137,844 out of    144,773 ( 95.2%) truth set loci, and out of  4,722,859 (  2.9%) TRFPureRepeats6bp loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif
TRFPureRepeats6bp             :        453 out of    144,773 (  0.3%) truth set loci, and out of  4,722,859 (  0.0%) TRFPureRepeats6bp loci:     STR locus is contained within truth set STR locus             and has different motif
TRFPureRepeats6bp             :          3 out of    144,773 (  0.0%) truth set loci, and out of  4,722,859 (  0.0%) TRFPureRepeats6bp loci:     STR locus is contained within truth set STR locus             and has same motif after normalization
TRFPureRepeats6bp             :          1 out of    144,773 (  0.0%) truth set loci, and out of  4,722,859 (  0.0%) TRFPureRepeats6bp loci:     STR locus is contained within truth set STR locus             and has same motif
TRFPureRepeats6bp             :        152 out of    144,773 (  0.1%) truth set loci, and out of  4,722,859 (  0.0%) TRFPureRepeats6bp loci:     STR locus contains truth set STR locus                        and has different motif
TRFPureRepeats6bp             :          6 out of    144,773 (  0.0%) truth set loci, and out of  4,722,859 (  0.0%) TRFPureRepeats6bp loci:     STR locus contains truth set STR locus                        and has same motif
TRFPureRepeats6bp             :        815 out of    144,773 (  0.6%) truth set loci, and out of  4,722,859 (  0.0%) TRFPureRepeats6bp loci:     STR loci overlap                                              and has different motif
TRFPureRepeats6bp             :         45 out of    144,773 (  0.0%) truth set loci, and out of  4,722,859 (  0.0%) TRFPureRepeats6bp loci:     STR loci overlap                                              and has same motif after normalization
TRFPureRepeats6bp             :         20 out of    144,773 (  0.0%) truth set loci, and out of  4,722,859 (  0.0%) TRFPureRepeats6bp loci:     STR loci overlap                                              and has same motif
TRFPureRepeats6bp             :      5,434 out of    144,773 (  3.8%) truth set loci:     no overlap                                                  
TRFPureRepeats9bp             :    136,665 out of    144,773 ( 94.4%) truth set loci, and out of  2,805,842 (  4.9%) TRFPureRepeats9bp loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif
TRFPureRepeats9bp             :        200 out of    144,773 (  0.1%) truth set loci, and out of  2,805,842 (  0.0%) TRFPureRepeats9bp loci:     STR locus is contained within truth set STR locus             and has different motif
TRFPureRepeats9bp             :          3 out of    144,773 (  0.0%) truth set loci, and out of  2,805,842 (  0.0%) TRFPureRepeats9bp loci:     STR locus is contained within truth set STR locus             and has same motif after normalization
TRFPureRepeats9bp             :          1 out of    144,773 (  0.0%) truth set loci, and out of  2,805,842 (  0.0%) TRFPureRepeats9bp loci:     STR locus is contained within truth set STR locus             and has same motif
TRFPureRepeats9bp             :        201 out of    144,773 (  0.1%) truth set loci, and out of  2,805,842 (  0.0%) TRFPureRepeats9bp loci:     STR locus contains truth set STR locus                        and has different motif
TRFPureRepeats9bp             :          6 out of    144,773 (  0.0%) truth set loci, and out of  2,805,842 (  0.0%) TRFPureRepeats9bp loci:     STR locus contains truth set STR locus                        and has same motif
TRFPureRepeats9bp             :        845 out of    144,773 (  0.6%) truth set loci, and out of  2,805,842 (  0.0%) TRFPureRepeats9bp loci:     STR loci overlap                                              and has different motif
TRFPureRepeats9bp             :         45 out of    144,773 (  0.0%) truth set loci, and out of  2,805,842 (  0.0%) TRFPureRepeats9bp loci:     STR loci overlap                                              and has same motif after normalization
TRFPureRepeats9bp             :         20 out of    144,773 (  0.0%) truth set loci, and out of  2,805,842 (  0.0%) TRFPureRepeats9bp loci:     STR loci overlap                                              and has same motif
TRFPureRepeats9bp             :      6,787 out of    144,773 (  4.7%) truth set loci:     no overlap                                                  
Done
Wrote 175,372 rows to the output tsv: step7.filtered_STRs.alleles.with_overlap_columns.tsv.gz
GangSTRCatalog13              :     79,627 out of    175,372 ( 45.4%) truth set loci, and out of    832,380 (  9.6%) GangSTRCatalog13 loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif
GangSTRCatalog13              :        785 out of    175,372 (  0.4%) truth set loci, and out of    832,380 (  0.1%) GangSTRCatalog13 loci:     STR locus is contained within truth set STR locus             and has same motif after normalization
GangSTRCatalog13              :          8 out of    175,372 (  0.0%) truth set loci, and out of    832,380 (  0.0%) GangSTRCatalog13 loci:     STR locus is contained within truth set STR locus             and has different motif
GangSTRCatalog13              :         15 out of    175,372 (  0.0%) truth set loci, and out of    832,380 (  0.0%) GangSTRCatalog13 loci:     STR locus contains truth set STR locus                        and has different motif
GangSTRCatalog13              :          1 out of    175,372 (  0.0%) truth set loci, and out of    832,380 (  0.0%) GangSTRCatalog13 loci:     STR locus contains truth set STR locus                        and has same motif
GangSTRCatalog13              :      1,049 out of    175,372 (  0.6%) truth set loci, and out of    832,380 (  0.1%) GangSTRCatalog13 loci:     STR loci overlap                                              and has same motif after normalization
GangSTRCatalog13              :        688 out of    175,372 (  0.4%) truth set loci, and out of    832,380 (  0.1%) GangSTRCatalog13 loci:     STR loci overlap                                              and has different motif
GangSTRCatalog13              :          2 out of    175,372 (  0.0%) truth set loci, and out of    832,380 (  0.0%) GangSTRCatalog13 loci:     STR loci overlap                                              and has same motif
GangSTRCatalog13              :     93,197 out of    175,372 ( 53.1%) truth set loci:     no overlap                                                  
GangSTRCatalog17              :    101,524 out of    175,372 ( 57.9%) truth set loci, and out of  1,340,266 (  7.6%) GangSTRCatalog17 loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif
GangSTRCatalog17              :      1,210 out of    175,372 (  0.7%) truth set loci, and out of  1,340,266 (  0.1%) GangSTRCatalog17 loci:     STR locus is contained within truth set STR locus             and has same motif after normalization
GangSTRCatalog17              :         56 out of    175,372 (  0.0%) truth set loci, and out of  1,340,266 (  0.0%) GangSTRCatalog17 loci:     STR locus is contained within truth set STR locus             and has different motif
GangSTRCatalog17              :         36 out of    175,372 (  0.0%) truth set loci, and out of  1,340,266 (  0.0%) GangSTRCatalog17 loci:     STR locus contains truth set STR locus                        and has different motif
GangSTRCatalog17              :          1 out of    175,372 (  0.0%) truth set loci, and out of  1,340,266 (  0.0%) GangSTRCatalog17 loci:     STR locus contains truth set STR locus                        and has same motif
GangSTRCatalog17              :      2,119 out of    175,372 (  1.2%) truth set loci, and out of  1,340,266 (  0.2%) GangSTRCatalog17 loci:     STR loci overlap                                              and has different motif
GangSTRCatalog17              :      1,537 out of    175,372 (  0.9%) truth set loci, and out of  1,340,266 (  0.1%) GangSTRCatalog17 loci:     STR loci overlap                                              and has same motif after normalization
GangSTRCatalog17              :          3 out of    175,372 (  0.0%) truth set loci, and out of  1,340,266 (  0.0%) GangSTRCatalog17 loci:     STR loci overlap                                              and has same motif
GangSTRCatalog17              :     68,886 out of    175,372 ( 39.3%) truth set loci:     no overlap                                                  
IlluminaSTRCatalog            :    108,831 out of    175,372 ( 62.1%) truth set loci, and out of    174,300 ( 62.4%) IlluminaSTRCatalog loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif
IlluminaSTRCatalog            :      1,040 out of    175,372 (  0.6%) truth set loci, and out of    174,300 (  0.6%) IlluminaSTRCatalog loci:     STR locus is contained within truth set STR locus             and has same motif
IlluminaSTRCatalog            :         42 out of    175,372 (  0.0%) truth set loci, and out of    174,300 (  0.0%) IlluminaSTRCatalog loci:     STR locus is contained within truth set STR locus             and has same motif after normalization
IlluminaSTRCatalog            :         27 out of    175,372 (  0.0%) truth set loci, and out of    174,300 (  0.0%) IlluminaSTRCatalog loci:     STR locus is contained within truth set STR locus             and has different motif
IlluminaSTRCatalog            :      3,919 out of    175,372 (  2.2%) truth set loci, and out of    174,300 (  2.2%) IlluminaSTRCatalog loci:     STR locus contains truth set STR locus                        and has same motif
IlluminaSTRCatalog            :        104 out of    175,372 (  0.1%) truth set loci, and out of    174,300 (  0.1%) IlluminaSTRCatalog loci:     STR locus contains truth set STR locus                        and has same motif after normalization
IlluminaSTRCatalog            :         24 out of    175,372 (  0.0%) truth set loci, and out of    174,300 (  0.0%) IlluminaSTRCatalog loci:     STR locus contains truth set STR locus                        and has different motif
IlluminaSTRCatalog            :        180 out of    175,372 (  0.1%) truth set loci, and out of    174,300 (  0.1%) IlluminaSTRCatalog loci:     STR loci overlap                                              and has different motif
IlluminaSTRCatalog            :        175 out of    175,372 (  0.1%) truth set loci, and out of    174,300 (  0.1%) IlluminaSTRCatalog loci:     STR loci overlap                                              and has same motif after normalization
IlluminaSTRCatalog            :         56 out of    175,372 (  0.0%) truth set loci, and out of    174,300 (  0.0%) IlluminaSTRCatalog loci:     STR loci overlap                                              and has same motif
IlluminaSTRCatalog            :     60,974 out of    175,372 ( 34.8%) truth set loci:     no overlap                                                  
KnownDiseaseAssociatedSTRs    :         14 out of    175,372 (  0.0%) truth set loci, and out of         60 ( 23.3%) KnownDiseaseAssociatedSTRs loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif
KnownDiseaseAssociatedSTRs    :          5 out of    175,372 (  0.0%) truth set loci, and out of         60 (  8.3%) KnownDiseaseAssociatedSTRs loci:     STR locus is contained within truth set STR locus             and has same motif after normalization
KnownDiseaseAssociatedSTRs    :          5 out of    175,372 (  0.0%) truth set loci, and out of         60 (  8.3%) KnownDiseaseAssociatedSTRs loci:     STR locus contains truth set STR locus                        and has same motif
KnownDiseaseAssociatedSTRs    :          3 out of    175,372 (  0.0%) truth set loci, and out of         60 (  5.0%) KnownDiseaseAssociatedSTRs loci:     STR locus contains truth set STR locus                        and has same motif after normalization
KnownDiseaseAssociatedSTRs    :          4 out of    175,372 (  0.0%) truth set loci, and out of         60 (  6.7%) KnownDiseaseAssociatedSTRs loci:     STR loci overlap                                              and has same motif after normalization
KnownDiseaseAssociatedSTRs    :          1 out of    175,372 (  0.0%) truth set loci, and out of         60 (  1.7%) KnownDiseaseAssociatedSTRs loci:     STR loci overlap                                              and has different motif
KnownDiseaseAssociatedSTRs    :    175,340 out of    175,372 (100.0%) truth set loci:     no overlap                                                  
SegDupIntervals               :      3,663 out of    175,372 (  2.1%) truth set loci, and out of     64,222 (  5.7%) SegDupIntervals loci:     interval contains truth set STR locus                       
SegDupIntervals               :         34 out of    175,372 (  0.0%) truth set loci, and out of     64,222 (  0.1%) SegDupIntervals loci:     interval overlaps truth set STR locus                       
SegDupIntervals               :    171,675 out of    175,372 ( 97.9%) truth set loci:     no overlap                                                  
TRFPureRepeats12bp            :    162,077 out of    175,372 ( 92.4%) truth set loci, and out of  1,343,313 ( 12.1%) TRFPureRepeats12bp loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif
TRFPureRepeats12bp            :        112 out of    175,372 (  0.1%) truth set loci, and out of  1,343,313 (  0.0%) TRFPureRepeats12bp loci:     STR locus is contained within truth set STR locus             and has different motif
TRFPureRepeats12bp            :          4 out of    175,372 (  0.0%) truth set loci, and out of  1,343,313 (  0.0%) TRFPureRepeats12bp loci:     STR locus is contained within truth set STR locus             and has same motif after normalization
TRFPureRepeats12bp            :          1 out of    175,372 (  0.0%) truth set loci, and out of  1,343,313 (  0.0%) TRFPureRepeats12bp loci:     STR locus is contained within truth set STR locus             and has same motif
TRFPureRepeats12bp            :        324 out of    175,372 (  0.2%) truth set loci, and out of  1,343,313 (  0.0%) TRFPureRepeats12bp loci:     STR locus contains truth set STR locus                        and has different motif
TRFPureRepeats12bp            :          8 out of    175,372 (  0.0%) truth set loci, and out of  1,343,313 (  0.0%) TRFPureRepeats12bp loci:     STR locus contains truth set STR locus                        and has same motif
TRFPureRepeats12bp            :      1,045 out of    175,372 (  0.6%) truth set loci, and out of  1,343,313 (  0.1%) TRFPureRepeats12bp loci:     STR loci overlap                                              and has different motif
TRFPureRepeats12bp            :         49 out of    175,372 (  0.0%) truth set loci, and out of  1,343,313 (  0.0%) TRFPureRepeats12bp loci:     STR loci overlap                                              and has same motif after normalization
TRFPureRepeats12bp            :         19 out of    175,372 (  0.0%) truth set loci, and out of  1,343,313 (  0.0%) TRFPureRepeats12bp loci:     STR loci overlap                                              and has same motif
TRFPureRepeats12bp            :     11,733 out of    175,372 (  6.7%) truth set loci:     no overlap                                                  
TRFPureRepeats15bp            :    150,053 out of    175,372 ( 85.6%) truth set loci, and out of    702,486 ( 21.4%) TRFPureRepeats15bp loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif
TRFPureRepeats15bp            :         58 out of    175,372 (  0.0%) truth set loci, and out of    702,486 (  0.0%) TRFPureRepeats15bp loci:     STR locus is contained within truth set STR locus             and has different motif
TRFPureRepeats15bp            :          4 out of    175,372 (  0.0%) truth set loci, and out of    702,486 (  0.0%) TRFPureRepeats15bp loci:     STR locus is contained within truth set STR locus             and has same motif after normalization
TRFPureRepeats15bp            :          1 out of    175,372 (  0.0%) truth set loci, and out of    702,486 (  0.0%) TRFPureRepeats15bp loci:     STR locus is contained within truth set STR locus             and has same motif
TRFPureRepeats15bp            :        413 out of    175,372 (  0.2%) truth set loci, and out of    702,486 (  0.1%) TRFPureRepeats15bp loci:     STR locus contains truth set STR locus                        and has different motif
TRFPureRepeats15bp            :          8 out of    175,372 (  0.0%) truth set loci, and out of    702,486 (  0.0%) TRFPureRepeats15bp loci:     STR locus contains truth set STR locus                        and has same motif
TRFPureRepeats15bp            :      1,379 out of    175,372 (  0.8%) truth set loci, and out of    702,486 (  0.2%) TRFPureRepeats15bp loci:     STR loci overlap                                              and has different motif
TRFPureRepeats15bp            :         43 out of    175,372 (  0.0%) truth set loci, and out of    702,486 (  0.0%) TRFPureRepeats15bp loci:     STR loci overlap                                              and has same motif after normalization
TRFPureRepeats15bp            :         14 out of    175,372 (  0.0%) truth set loci, and out of    702,486 (  0.0%) TRFPureRepeats15bp loci:     STR loci overlap                                              and has same motif
TRFPureRepeats15bp            :     23,399 out of    175,372 ( 13.3%) truth set loci:     no overlap                                                  
TRFPureRepeats6bp             :    168,236 out of    175,372 ( 95.9%) truth set loci, and out of  4,722,859 (  3.6%) TRFPureRepeats6bp loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif
TRFPureRepeats6bp             :        469 out of    175,372 (  0.3%) truth set loci, and out of  4,722,859 (  0.0%) TRFPureRepeats6bp loci:     STR locus is contained within truth set STR locus             and has different motif
TRFPureRepeats6bp             :          4 out of    175,372 (  0.0%) truth set loci, and out of  4,722,859 (  0.0%) TRFPureRepeats6bp loci:     STR locus is contained within truth set STR locus             and has same motif after normalization
TRFPureRepeats6bp             :          1 out of    175,372 (  0.0%) truth set loci, and out of  4,722,859 (  0.0%) TRFPureRepeats6bp loci:     STR locus is contained within truth set STR locus             and has same motif
TRFPureRepeats6bp             :        157 out of    175,372 (  0.1%) truth set loci, and out of  4,722,859 (  0.0%) TRFPureRepeats6bp loci:     STR locus contains truth set STR locus                        and has different motif
TRFPureRepeats6bp             :          8 out of    175,372 (  0.0%) truth set loci, and out of  4,722,859 (  0.0%) TRFPureRepeats6bp loci:     STR locus contains truth set STR locus                        and has same motif
TRFPureRepeats6bp             :        822 out of    175,372 (  0.5%) truth set loci, and out of  4,722,859 (  0.0%) TRFPureRepeats6bp loci:     STR loci overlap                                              and has different motif
TRFPureRepeats6bp             :         48 out of    175,372 (  0.0%) truth set loci, and out of  4,722,859 (  0.0%) TRFPureRepeats6bp loci:     STR loci overlap                                              and has same motif after normalization
TRFPureRepeats6bp             :         21 out of    175,372 (  0.0%) truth set loci, and out of  4,722,859 (  0.0%) TRFPureRepeats6bp loci:     STR loci overlap                                              and has same motif
TRFPureRepeats6bp             :      5,606 out of    175,372 (  3.2%) truth set loci:     no overlap                                                  
TRFPureRepeats9bp             :    167,033 out of    175,372 ( 95.2%) truth set loci, and out of  2,805,842 (  6.0%) TRFPureRepeats9bp loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif
TRFPureRepeats9bp             :        205 out of    175,372 (  0.1%) truth set loci, and out of  2,805,842 (  0.0%) TRFPureRepeats9bp loci:     STR locus is contained within truth set STR locus             and has different motif
TRFPureRepeats9bp             :          4 out of    175,372 (  0.0%) truth set loci, and out of  2,805,842 (  0.0%) TRFPureRepeats9bp loci:     STR locus is contained within truth set STR locus             and has same motif after normalization
TRFPureRepeats9bp             :          1 out of    175,372 (  0.0%) truth set loci, and out of  2,805,842 (  0.0%) TRFPureRepeats9bp loci:     STR locus is contained within truth set STR locus             and has same motif
TRFPureRepeats9bp             :        206 out of    175,372 (  0.1%) truth set loci, and out of  2,805,842 (  0.0%) TRFPureRepeats9bp loci:     STR locus contains truth set STR locus                        and has different motif
TRFPureRepeats9bp             :          8 out of    175,372 (  0.0%) truth set loci, and out of  2,805,842 (  0.0%) TRFPureRepeats9bp loci:     STR locus contains truth set STR locus                        and has same motif
TRFPureRepeats9bp             :        854 out of    175,372 (  0.5%) truth set loci, and out of  2,805,842 (  0.0%) TRFPureRepeats9bp loci:     STR loci overlap                                              and has different motif
TRFPureRepeats9bp             :         48 out of    175,372 (  0.0%) truth set loci, and out of  2,805,842 (  0.0%) TRFPureRepeats9bp loci:     STR loci overlap                                              and has same motif after normalization
TRFPureRepeats9bp             :         21 out of    175,372 (  0.0%) truth set loci, and out of  2,805,842 (  0.0%) TRFPureRepeats9bp loci:     STR loci overlap                                              and has same motif
TRFPureRepeats9bp             :      6,992 out of    175,372 (  4.0%) truth set loci:     no overlap                                                  
Done
+ mv step7.filtered_STRs.variants.with_overlap_columns.tsv.gz step7.filtered_STRs.variants.tsv.gz
+ mv step7.filtered_STRs.alleles.with_overlap_columns.tsv.gz step7.filtered_STRs.alleles.tsv.gz
+ suffix=with_gencode_v42_columns
+ wait
+ python3 -u scripts/compute_overlap_with_gene_models.py ./ref/other/gencode.v42.annotation.gtf.gz step7.filtered_STRs.alleles.tsv.gz step7.filtered_STRs.alleles.with_gencode_v42_columns.tsv.gz
+ python3 -u scripts/compute_overlap_with_gene_models.py ./ref/other/gencode.v42.annotation.gtf.gz step7.filtered_STRs.variants.tsv.gz step7.filtered_STRs.variants.with_gencode_v42_columns.tsv.gz
 3,413,945 total
 1,643,237 exon
   883,132 CDS
   382,744 UTR
   252,416 transcript
   252,416 promoter
 3,413,945 total
 1,643,237 exon
   883,132 CDS
   382,744 UTR
   252,416 transcript
   252,416 promoter
scripts/compute_overlap_with_gene_models.py:234: DtypeWarning: Columns (28) have mixed types.Specify dtype option on import or set low_memory=False.
  main()
Processing rows from step7.filtered_STRs.variants.tsv.gz
Processing rows from step7.filtered_STRs.alleles.tsv.gz
Wrote 144,773 rows to the output tsv: step7.filtered_STRs.variants.with_gencode_v42_columns.tsv.gz
Wrote 175,372 rows to the output tsv: step7.filtered_STRs.alleles.with_gencode_v42_columns.tsv.gz
+ mv step7.filtered_STRs.variants.with_gencode_v42_columns.tsv.gz step7.filtered_STRs.variants.tsv.gz
+ mv step7.filtered_STRs.alleles.with_gencode_v42_columns.tsv.gz step7.filtered_STRs.alleles.tsv.gz
+ suffix=with_MANE_columns
+ wait
+ python3 -u scripts/compute_overlap_with_gene_models.py ./ref/other/MANE.v1.0.ensembl_genomic.gtf.gz step7.filtered_STRs.variants.tsv.gz step7.filtered_STRs.variants.with_MANE_columns.tsv.gz
+ python3 -u scripts/compute_overlap_with_gene_models.py ./ref/other/MANE.v1.0.ensembl_genomic.gtf.gz step7.filtered_STRs.alleles.tsv.gz step7.filtered_STRs.alleles.with_MANE_columns.tsv.gz
   481,072 total
   202,525 exon
   192,285 CDS
    48,022 UTR
    19,120 transcript
    19,120 promoter
   481,072 total
   202,525 exon
   192,285 CDS
    48,022 UTR
    19,120 transcript
    19,120 promoter
Processing rows from step7.filtered_STRs.variants.tsv.gz
scripts/compute_overlap_with_gene_models.py:234: DtypeWarning: Columns (28) have mixed types.Specify dtype option on import or set low_memory=False.
  main()
Processing rows from step7.filtered_STRs.alleles.tsv.gz
Wrote 144,773 rows to the output tsv: step7.filtered_STRs.variants.with_MANE_columns.tsv.gz
Wrote 175,372 rows to the output tsv: step7.filtered_STRs.alleles.with_MANE_columns.tsv.gz
+ mv step7.filtered_STRs.variants.with_MANE_columns.tsv.gz step7.filtered_STRs.variants.tsv.gz
+ mv step7.filtered_STRs.alleles.with_MANE_columns.tsv.gz step7.filtered_STRs.alleles.tsv.gz
+ final_output_prefix=STR_truthset.v1
+ mv step7.filtered_STRs.variants.tsv.gz STR_truthset.v1.variants.tsv.gz
+ mv step7.filtered_STRs.alleles.tsv.gz STR_truthset.v1.alleles.tsv.gz
+ mv step7.filtered_STRs.variants.bed.gz STR_truthset.v1.variants.bed.gz
+ mv step7.filtered_STRs.variants.bed.gz.tbi STR_truthset.v1.variants.bed.gz.tbi
+ mv step7.filtered_STRs.vcf.gz STR_truthset.v1.vcf.gz
+ mv step7.filtered_STRs.vcf.gz.tbi STR_truthset.v1.vcf.gz.tbi
+ python3 tool_comparison/scripts/convert_truth_set_to_variant_catalogs.py --expansion-hunter-loci-per-run 500 --gangstr-loci-per-run 10000 --output-dir ./tool_comparison/variant_catalogs --high-confidence-regions-bed ./ref/full.38.bed.gz --all-repeats-bed ./ref/other/repeat_specs_GRCh38_without_mismatches.sorted.trimmed.at_least_9bp.bed.gz STR_truthset.v1.variants.tsv.gz
Parsed 144773 records from STR_truthset.v1.variants.tsv.gz
Discarded 521 loci without matching repeats in the reference
Generated 144,251 positive loci
Loaded 2,527,207 STRs in hg38 within the SynDip high-confidence regions
Generated 144,252 negative loci
Wrote 289 ExpansionHunter variant catalogs to ./tool_comparison/variant_catalogs/expansion_hunter/positive_loci.EHv5*.json
Wrote 15 GangSTR repeat spec bed files to ./tool_comparison/variant_catalogs/gangstr/positive_loci.GangSTR*.bed
Wrote 15 GangSTR repeat spec bed files to ./tool_comparison/variant_catalogs/hipstr/positive_loci.HipSTR*.bed
Wrote 144,251 loci to ./tool_comparison/variant_catalogs/positive_loci.bed.gz
Wrote 289 ExpansionHunter variant catalogs to ./tool_comparison/variant_catalogs/expansion_hunter/negative_loci.EHv5*.json
Wrote 15 GangSTR repeat spec bed files to ./tool_comparison/variant_catalogs/gangstr/negative_loci.GangSTR*.bed
Wrote 15 GangSTR repeat spec bed files to ./tool_comparison/variant_catalogs/hipstr/negative_loci.HipSTR*.bed
Wrote 144,252 loci to ./tool_comparison/variant_catalogs/negative_loci.bed.gz
Done
+ negative_loci_bed_path=tool_comparison/variant_catalogs/negative_loci.bed.gz
+ output_prefix=tool_comparison/variant_catalogs/negative_loci
+ suffix=with_overlap_columns
+ python3 -u scripts/compute_overlap_with_other_catalogs.py tool_comparison/variant_catalogs/negative_loci.bed.gz tool_comparison/variant_catalogs/negative_loci.with_overlap_columns.tsv.gz
scripts/compute_overlap_with_other_catalogs.py:298: DtypeWarning: Columns (0) have mixed types.Specify dtype option on import or set low_memory=False.
  main()
Parsed    174,300 intervals from IlluminaSTRCatalog                       ./ref/other/illumina_variant_catalog.sorted.bed.gz
Parsed  1,340,266 intervals from GangSTRCatalog17                         ./ref/other/hg38_ver17.fixed.bed.gz
Parsed    832,380 intervals from GangSTRCatalog13                         ./ref/other/hg38_ver13.fixed.bed.gz
Parsed         60 intervals from KnownDiseaseAssociatedSTRs               ./ref/other/known_disease_associated_STR_loci.GRCh38.bed.gz
Parsed    702,486 intervals from TRFPureRepeats15bp                       ./ref/other/repeat_specs_GRCh38_without_mismatches.sorted.trimmed.at_least_15bp.bed.gz
Parsed  1,343,313 intervals from TRFPureRepeats12bp                       ./ref/other/repeat_specs_GRCh38_without_mismatches.sorted.trimmed.at_least_12bp.bed.gz
Parsed  2,805,842 intervals from TRFPureRepeats9bp                        ./ref/other/repeat_specs_GRCh38_without_mismatches.sorted.trimmed.at_least_9bp.bed.gz
Parsed  4,722,859 intervals from TRFPureRepeats6bp                        ./ref/other/repeat_specs_GRCh38_without_mismatches.sorted.trimmed.at_least_6bp.bed.gz
Parsed     64,222 intervals from SegDupIntervals                          ./ref/other/GRCh38GenomicSuperDup.without_decoys.sorted.bed.gz
Processing rows from tool_comparison/variant_catalogs/negative_loci.bed.gz
Wrote 144,252 rows to the output tsv: tool_comparison/variant_catalogs/negative_loci.with_overlap_columns.tsv.gz
GangSTRCatalog13              :     40,271 out of    144,252 ( 27.9%) truth set loci, and out of    832,380 (  4.8%) GangSTRCatalog13 loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif
GangSTRCatalog13              :         64 out of    144,252 (  0.0%) truth set loci, and out of    832,380 (  0.0%) GangSTRCatalog13 loci:     STR locus has exact same coordinates as truth set STR locus   and has different motif
GangSTRCatalog13              :          1 out of    144,252 (  0.0%) truth set loci, and out of    832,380 (  0.0%) GangSTRCatalog13 loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif after normalization
GangSTRCatalog13              :        797 out of    144,252 (  0.6%) truth set loci, and out of    832,380 (  0.1%) GangSTRCatalog13 loci:     STR locus is contained within truth set STR locus             and has same motif after normalization
GangSTRCatalog13              :          1 out of    144,252 (  0.0%) truth set loci, and out of    832,380 (  0.0%) GangSTRCatalog13 loci:     STR locus is contained within truth set STR locus             and has different motif
GangSTRCatalog13              :         15 out of    144,252 (  0.0%) truth set loci, and out of    832,380 (  0.0%) GangSTRCatalog13 loci:     STR locus contains truth set STR locus                        and has different motif
GangSTRCatalog13              :        865 out of    144,252 (  0.6%) truth set loci, and out of    832,380 (  0.1%) GangSTRCatalog13 loci:     STR loci overlap                                              and has different motif
GangSTRCatalog13              :        650 out of    144,252 (  0.5%) truth set loci, and out of    832,380 (  0.1%) GangSTRCatalog13 loci:     STR loci overlap                                              and has same motif after normalization
GangSTRCatalog13              :    101,588 out of    144,252 ( 70.4%) truth set loci:     no overlap                                                  
GangSTRCatalog17              :     52,686 out of    144,252 ( 36.5%) truth set loci, and out of  1,340,266 (  3.9%) GangSTRCatalog17 loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif
GangSTRCatalog17              :         64 out of    144,252 (  0.0%) truth set loci, and out of  1,340,266 (  0.0%) GangSTRCatalog17 loci:     STR locus has exact same coordinates as truth set STR locus   and has different motif
GangSTRCatalog17              :          1 out of    144,252 (  0.0%) truth set loci, and out of  1,340,266 (  0.0%) GangSTRCatalog17 loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif after normalization
GangSTRCatalog17              :        404 out of    144,252 (  0.3%) truth set loci, and out of  1,340,266 (  0.0%) GangSTRCatalog17 loci:     STR locus is contained within truth set STR locus             and has same motif after normalization
GangSTRCatalog17              :         56 out of    144,252 (  0.0%) truth set loci, and out of  1,340,266 (  0.0%) GangSTRCatalog17 loci:     STR locus is contained within truth set STR locus             and has different motif
GangSTRCatalog17              :         54 out of    144,252 (  0.0%) truth set loci, and out of  1,340,266 (  0.0%) GangSTRCatalog17 loci:     STR locus contains truth set STR locus                        and has different motif
GangSTRCatalog17              :      1,805 out of    144,252 (  1.3%) truth set loci, and out of  1,340,266 (  0.1%) GangSTRCatalog17 loci:     STR loci overlap                                              and has different motif
GangSTRCatalog17              :        900 out of    144,252 (  0.6%) truth set loci, and out of  1,340,266 (  0.1%) GangSTRCatalog17 loci:     STR loci overlap                                              and has same motif after normalization
GangSTRCatalog17              :          1 out of    144,252 (  0.0%) truth set loci, and out of  1,340,266 (  0.0%) GangSTRCatalog17 loci:     STR loci overlap                                              and has same motif
GangSTRCatalog17              :     88,281 out of    144,252 ( 61.2%) truth set loci:     no overlap                                                  
IlluminaSTRCatalog            :      9,870 out of    144,252 (  6.8%) truth set loci, and out of    174,300 (  5.7%) IlluminaSTRCatalog loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif
IlluminaSTRCatalog            :         69 out of    144,252 (  0.0%) truth set loci, and out of    174,300 (  0.0%) IlluminaSTRCatalog loci:     STR locus has exact same coordinates as truth set STR locus   and has different motif
IlluminaSTRCatalog            :        102 out of    144,252 (  0.1%) truth set loci, and out of    174,300 (  0.1%) IlluminaSTRCatalog loci:     STR locus is contained within truth set STR locus             and has same motif after normalization
IlluminaSTRCatalog            :         54 out of    144,252 (  0.0%) truth set loci, and out of    174,300 (  0.0%) IlluminaSTRCatalog loci:     STR locus is contained within truth set STR locus             and has same motif
IlluminaSTRCatalog            :          9 out of    144,252 (  0.0%) truth set loci, and out of    174,300 (  0.0%) IlluminaSTRCatalog loci:     STR locus is contained within truth set STR locus             and has different motif
IlluminaSTRCatalog            :        331 out of    144,252 (  0.2%) truth set loci, and out of    174,300 (  0.2%) IlluminaSTRCatalog loci:     STR locus contains truth set STR locus                        and has same motif
IlluminaSTRCatalog            :         46 out of    144,252 (  0.0%) truth set loci, and out of    174,300 (  0.0%) IlluminaSTRCatalog loci:     STR locus contains truth set STR locus                        and has same motif after normalization
IlluminaSTRCatalog            :         13 out of    144,252 (  0.0%) truth set loci, and out of    174,300 (  0.0%) IlluminaSTRCatalog loci:     STR locus contains truth set STR locus                        and has different motif
IlluminaSTRCatalog            :        457 out of    144,252 (  0.3%) truth set loci, and out of    174,300 (  0.3%) IlluminaSTRCatalog loci:     STR loci overlap                                              and has different motif
IlluminaSTRCatalog            :        229 out of    144,252 (  0.2%) truth set loci, and out of    174,300 (  0.1%) IlluminaSTRCatalog loci:     STR loci overlap                                              and has same motif after normalization
IlluminaSTRCatalog            :          7 out of    144,252 (  0.0%) truth set loci, and out of    174,300 (  0.0%) IlluminaSTRCatalog loci:     STR loci overlap                                              and has same motif
IlluminaSTRCatalog            :    133,065 out of    144,252 ( 92.2%) truth set loci:     no overlap                                                  
KnownDiseaseAssociatedSTRs    :         66 out of    144,252 (  0.0%) truth set loci, and out of         60 (110.0%) KnownDiseaseAssociatedSTRs loci:     STR locus has exact same coordinates as truth set STR locus   and has different motif
KnownDiseaseAssociatedSTRs    :          1 out of    144,252 (  0.0%) truth set loci, and out of         60 (  1.7%) KnownDiseaseAssociatedSTRs loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif
KnownDiseaseAssociatedSTRs    :          1 out of    144,252 (  0.0%) truth set loci, and out of         60 (  1.7%) KnownDiseaseAssociatedSTRs loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif after normalization
KnownDiseaseAssociatedSTRs    :          1 out of    144,252 (  0.0%) truth set loci, and out of         60 (  1.7%) KnownDiseaseAssociatedSTRs loci:     STR locus contains truth set STR locus                        and has same motif after normalization
KnownDiseaseAssociatedSTRs    :    144,183 out of    144,252 (100.0%) truth set loci:     no overlap                                                  
SegDupIntervals               :      3,487 out of    144,252 (  2.4%) truth set loci, and out of     64,222 (  5.4%) SegDupIntervals loci:     interval contains truth set STR locus                       
SegDupIntervals               :         21 out of    144,252 (  0.0%) truth set loci, and out of     64,222 (  0.0%) SegDupIntervals loci:     interval overlaps truth set STR locus                       
SegDupIntervals               :    140,744 out of    144,252 ( 97.6%) truth set loci:     no overlap                                                  
TRFPureRepeats12bp            :     93,126 out of    144,252 ( 64.6%) truth set loci, and out of  1,343,313 (  6.9%) TRFPureRepeats12bp loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif
TRFPureRepeats12bp            :        453 out of    144,252 (  0.3%) truth set loci, and out of  1,343,313 (  0.0%) TRFPureRepeats12bp loci:     STR locus contains truth set STR locus                        and has different motif
TRFPureRepeats12bp            :      1,249 out of    144,252 (  0.9%) truth set loci, and out of  1,343,313 (  0.1%) TRFPureRepeats12bp loci:     STR loci overlap                                              and has different motif
TRFPureRepeats12bp            :          2 out of    144,252 (  0.0%) truth set loci, and out of  1,343,313 (  0.0%) TRFPureRepeats12bp loci:     STR loci overlap                                              and has same motif after normalization
TRFPureRepeats12bp            :     49,422 out of    144,252 ( 34.3%) truth set loci:     no overlap                                                  
TRFPureRepeats15bp            :     43,630 out of    144,252 ( 30.2%) truth set loci, and out of    702,486 (  6.2%) TRFPureRepeats15bp loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif
TRFPureRepeats15bp            :        710 out of    144,252 (  0.5%) truth set loci, and out of    702,486 (  0.1%) TRFPureRepeats15bp loci:     STR locus contains truth set STR locus                        and has different motif
TRFPureRepeats15bp            :      2,240 out of    144,252 (  1.6%) truth set loci, and out of    702,486 (  0.3%) TRFPureRepeats15bp loci:     STR loci overlap                                              and has different motif
TRFPureRepeats15bp            :         28 out of    144,252 (  0.0%) truth set loci, and out of    702,486 (  0.0%) TRFPureRepeats15bp loci:     STR loci overlap                                              and has same motif after normalization
TRFPureRepeats15bp            :         10 out of    144,252 (  0.0%) truth set loci, and out of    702,486 (  0.0%) TRFPureRepeats15bp loci:     STR loci overlap                                              and has same motif
TRFPureRepeats15bp            :     97,634 out of    144,252 ( 67.7%) truth set loci:     no overlap                                                  
TRFPureRepeats6bp             :    144,252 out of    144,252 (100.0%) truth set loci, and out of  4,722,859 (  3.1%) TRFPureRepeats6bp loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif
TRFPureRepeats9bp             :    144,252 out of    144,252 (100.0%) truth set loci, and out of  2,805,842 (  5.1%) TRFPureRepeats9bp loci:     STR locus has exact same coordinates as truth set STR locus   and has same motif
Done
+ mv tool_comparison/variant_catalogs/negative_loci.with_overlap_columns.tsv.gz tool_comparison/variant_catalogs/negative_loci.tsv.gz
+ suffix=with_gencode_v42_columns
+ python3 -u scripts/compute_overlap_with_gene_models.py ./ref/other/gencode.v42.annotation.gtf.gz tool_comparison/variant_catalogs/negative_loci.tsv.gz tool_comparison/variant_catalogs/negative_loci.with_gencode_v42_columns.tsv.gz
 3,413,945 total
 1,643,237 exon
   883,132 CDS
   382,744 UTR
   252,416 transcript
   252,416 promoter
scripts/compute_overlap_with_gene_models.py:234: DtypeWarning: Columns (0,13) have mixed types.Specify dtype option on import or set low_memory=False.
  main()
Processing rows from tool_comparison/variant_catalogs/negative_loci.tsv.gz
Wrote 144,252 rows to the output tsv: tool_comparison/variant_catalogs/negative_loci.with_gencode_v42_columns.tsv.gz
+ mv tool_comparison/variant_catalogs/negative_loci.with_gencode_v42_columns.tsv.gz tool_comparison/variant_catalogs/negative_loci.tsv.gz
+ suffix=with_MANE_columns
+ python3 -u scripts/compute_overlap_with_gene_models.py ./ref/other/MANE.v1.0.ensembl_genomic.gtf.gz tool_comparison/variant_catalogs/negative_loci.tsv.gz tool_comparison/variant_catalogs/negative_loci.with_MANE_columns.tsv.gz
   481,072 total
   202,525 exon
   192,285 CDS
    48,022 UTR
    19,120 transcript
    19,120 promoter
scripts/compute_overlap_with_gene_models.py:234: DtypeWarning: Columns (0,13) have mixed types.Specify dtype option on import or set low_memory=False.
  main()
Processing rows from tool_comparison/variant_catalogs/negative_loci.tsv.gz
Wrote 144,252 rows to the output tsv: tool_comparison/variant_catalogs/negative_loci.with_MANE_columns.tsv.gz
+ mv tool_comparison/variant_catalogs/negative_loci.with_MANE_columns.tsv.gz tool_comparison/variant_catalogs/negative_loci.tsv.gz
+ set +x
===============
