+ python3 -m pip install -r requirements.txt -qq
+ set +x
===============
step0:STR:  Parsing ./ref/full.38.vcf.gz
step0:STR:  bgzip -f ./ref/full.38.INDELs.vcf
step0:STR:  tabix -f ./ref/full.38.INDELs.vcf.gz
step0:STR:  Wrote 1,138,023 INDELs to ./ref/full.38.INDELs.vcf.gz
step0:STR:     5,182,765 out of  5,182,765 ( 100.0%) total variant variants
step0:STR:     4,058,663 out of  5,182,765 (  78.3%) SNV/MNV variants
step0:STR:     1,138,023 out of  5,182,765 (  22.0%) INDEL variants
step0:STR:     5,327,703 out of  5,327,703 ( 100.0%) total alleles
step0:STR:     1,266,927 out of  5,327,703 (  23.8%) INDEL alleles
step0:STR:       644,138 out of  5,327,703 (  12.1%) INS alleles
step0:STR:       622,789 out of  5,327,703 (  11.7%) DEL alleles
===============
STEP #1: Filter SynDip truth set to SynDip high confidence regions
         INPUT: ./ref/full.38.vcf.gz        5182765 variants
+ tabix -f ./ref/full.38.bed.gz
+ bedtools intersect -header -f 1 -wa -u -a ./ref/full.38.vcf.gz -b ./ref/full.38.bed.gz
+ bgzip
+ tabix -f step1.high_confidence_regions.vcf.gz
+ set +x
         OUTPUT: step1.high_confidence_regions.vcf.gz         4081549 variants
step1:input:      VCF stats for the input vcf -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --  ./ref/full.38.vcf.gz
step1:input:       5,182,765 TOTAL variants
step1:input:       5,327,703 TOTAL alleles (1.03 alleles per variant)
--------------
step1:input:       1,733,759 out of  5,182,765 ( 33.5%) genotype: 1|1
step1:input:       1,504,467 out of  5,182,765 ( 29.0%) genotype: 0|1
step1:input:       1,495,334 out of  5,182,765 ( 28.9%) genotype: 1|0
step1:input:         115,177 out of  5,182,765 (  2.2%) genotype: 1|.
step1:input:          89,241 out of  5,182,765 (  1.7%) genotype: 2|1
step1:input:          86,403 out of  5,182,765 (  1.7%) genotype: 1|2
step1:input:          58,317 out of  5,182,765 (  1.1%) genotype: .|1
step1:input:          43,013 out of  5,182,765 (  0.8%) genotype: .|.
step1:input:          33,528 out of  5,182,765 (  0.6%) genotype: .|0
step1:input:          22,555 out of  5,182,765 (  0.4%) genotype: 0|.
step1:input:             695 out of  5,182,765 (  0.0%) genotype: .|2
step1:input:             203 out of  5,182,765 (  0.0%) genotype: 2|.
step1:input:              52 out of  5,182,765 (  0.0%) genotype: .|3
step1:input:              21 out of  5,182,765 (  0.0%) genotype: 3|.
--------------
step1:input:       5,182,765 out of  5,182,765 (100.0%) TOTAL variants
step1:input:       4,039,494 out of  5,182,765 ( 77.9%) SNV variants
step1:input:         516,286 out of  5,182,765 ( 10.0%) DEL variants
step1:input:         484,214 out of  5,182,765 (  9.3%) INS variants
step1:input:          56,617 out of  5,182,765 (  1.1%) multiallelic INS variants
step1:input:          39,983 out of  5,182,765 (  0.8%) mixed multiallelic INS/DEL variants
step1:input:          32,069 out of  5,182,765 (  0.6%) multiallelic DEL variants
step1:input:           6,562 out of  5,182,765 (  0.1%) mixed multiallelic INS/SNV variants
step1:input:           5,156 out of  5,182,765 (  0.1%) multiallelic SNV variants
step1:input:           2,286 out of  5,182,765 (  0.0%) mixed multiallelic DEL/SNV variants
step1:input:              92 out of  5,182,765 (  0.0%) mixed multiallelic  variants
step1:input:               6 out of  5,182,765 (  0.0%) mixed multiallelic INS/DEL/SNV variants
--------------
step1:input:       5,327,703 out of  5,327,703 (100.0%) TOTAL alleles
step1:input:       4,056,362 out of  5,327,703 ( 76.1%) SNV alleles
step1:input:         644,138 out of  5,327,703 ( 12.1%) INS alleles
step1:input:         622,789 out of  5,327,703 ( 11.7%) DEL alleles
step1:input:           2,301 out of  5,327,703 (  0.0%) MNV alleles
step1:input:           2,113 out of  5,327,703 (  0.0%) complex MNV indel alleles
--------------
step1:output:      VCF stats for the output vcf -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --  step1.high_confidence_regions.vcf.gz
step1:output:       4,081,549 TOTAL variants
step1:output:       4,129,306 TOTAL alleles (1.01 alleles per variant)
--------------
step1:output:       1,532,880 out of  4,081,549 ( 37.6%) genotype: 1|1
step1:output:       1,245,186 out of  4,081,549 ( 30.5%) genotype: 1|0
step1:output:       1,236,615 out of  4,081,549 ( 30.3%) genotype: 0|1
step1:output:          33,466 out of  4,081,549 (  0.8%) genotype: 2|1
step1:output:          33,402 out of  4,081,549 (  0.8%) genotype: 1|2
--------------
step1:output:       4,081,549 out of  4,081,549 (100.0%) TOTAL variants
step1:output:       3,559,559 out of  4,081,549 ( 87.2%) SNV variants
step1:output:         238,413 out of  4,081,549 (  5.8%) INS variants
step1:output:         236,974 out of  4,081,549 (  5.8%) DEL variants
step1:output:          17,066 out of  4,081,549 (  0.4%) multiallelic INS variants
step1:output:          11,544 out of  4,081,549 (  0.3%) multiallelic DEL variants
step1:output:           9,985 out of  4,081,549 (  0.2%) mixed multiallelic INS/DEL variants
step1:output:           3,709 out of  4,081,549 (  0.1%) multiallelic SNV variants
step1:output:           3,171 out of  4,081,549 (  0.1%) mixed multiallelic INS/SNV variants
step1:output:           1,077 out of  4,081,549 (  0.0%) mixed multiallelic DEL/SNV variants
step1:output:              51 out of  4,081,549 (  0.0%) mixed multiallelic  variants
--------------
step1:output:       4,129,306 out of  4,129,306 (100.0%) TOTAL alleles
step1:output:       3,570,146 out of  4,129,306 ( 86.5%) SNV alleles
step1:output:         285,701 out of  4,129,306 (  6.9%) INS alleles
step1:output:         271,124 out of  4,129,306 (  6.6%) DEL alleles
step1:output:           1,256 out of  4,129,306 (  0.0%) complex MNV indel alleles
step1:output:           1,079 out of  4,129,306 (  0.0%) MNV alleles
--------------
step1:STR:  Parsing step1.high_confidence_regions.vcf.gz
step1:STR:  bgzip -f step1.high_confidence_regions.INDELs.vcf
step1:STR:  tabix -f step1.high_confidence_regions.INDELs.vcf.gz
step1:STR:  Wrote 518,230 INDELs to step1.high_confidence_regions.INDELs.vcf.gz
step1:STR:     4,081,549 out of  4,081,549 ( 100.0%) total variant variants
step1:STR:     3,571,225 out of  4,081,549 (  87.5%) SNV/MNV variants
step1:STR:       518,230 out of  4,081,549 (  12.7%) INDEL variants
step1:STR:     4,129,306 out of  4,129,306 ( 100.0%) total alleles
step1:STR:       556,825 out of  4,129,306 (  13.5%) INDEL alleles
step1:STR:       285,701 out of  4,129,306 (   6.9%) INS alleles
step1:STR:       271,124 out of  4,129,306 (   6.6%) DEL alleles
===============
Starting to process STRs: --allow-interruptions only-if-pure-repeats-not-found --min-repeat-unit-length 2 --max-repeat-unit-length 50
STEP #2: Filter variants to the subset that are actually STR expansion or contractions
         INPUT: step1.high_confidence_regions.vcf.gz        4081549 variants
+ python3 -u -m str_analysis.filter_vcf_to_STR_variants --allow-interruptions only-if-pure-repeats-not-found -R ./ref/hg38.fa --write-bed-file --min-str-length 9 --min-str-repeats 3 --min-repeat-unit-length 2 --max-repeat-unit-length 50 --output-prefix step2.STRs --write-vcf-with-filtered-out-variants --verbose step1.high_confidence_regions.vcf.gz
+ python3 -u scripts/add_prefix_to_stdout.py 'step2:STR:  '
step2:STR:  WARNING: vcf row #28,524: 1-19872728-19872835-T-TCTTTCTTC (RU:CTTT:3), TCTTTCTTTCTTCCTTCCTTC (RU:CTTC:3): interrupted multi-allelic STR has alleles with different RepeatUnit: CTTT  vs  CTTC   Skipping...
step2:STR:  WARNING: vcf row #35,813: 1-24219273-24219284-G-GCTTGCTTT (RU:CTTG:3), GCTTGCTTTCTTTCTTTCTTTCTTTCTTTCTTT (RU:CTTT:3): interrupted multi-allelic STR has alleles with different RepeatUnit: CTTG  vs  CTTT   Skipping...
step2:STR:  WARNING: vcf row #75,385: 1-56757688-56757755-C-CTTCTTTCT (RU:TTCT:3), CTTCCTTCCTTCCTTCCTTCCTTCCTTCCTTCTTTCTTTCT (RU:TTCC:3): interrupted multi-allelic STR has alleles with different RepeatUnit: TTCT  vs  TTCC   Skipping...
step2:STR:  WARNING: vcf row #100,040: 1-74702932-74702963-T-TGTGTGTGC (RU:GTGT:3), TGTGTGTGTGTGTGTGC (RU:GT:1): interrupted multi-allelic STR has alleles with different RepeatUnit: GTGT  vs  GT   Skipping...
step2:STR:  WARNING: vcf row #115,793: 1-85799212-85799247-A-AAAAAAAAGAAAGAAAGAAAGAAAGAAAGAAAGAAAG (RU:AAAGAAAGAAAG:3), AAAAAAAAGAAAGAAAGAAAGAAAGAAAGAAAG (RU:AAAGAAAG:3): interrupted multi-allelic STR has alleles with different RepeatUnit: AAAGAAAGAAAG  vs  AAAGAAAG   Skipping...
step2:STR:  WARNING: vcf row #141,846: 1-103937615-103937638-G-GTATATA (RU:TA:0), GTATATATAAATA (RU:TATA:0): interrupted multi-allelic STR has alleles with different RepeatUnit: TA  vs  TATA   Skipping...
step2:STR:  WARNING: vcf row #160,116: 1-116080889-116080904-T-TTCTTTCTCTCTC (RU:TCTC:3), TTCTTTCTTTCTTTCTTTCTC (RU:TCTT:3): interrupted multi-allelic STR has alleles with different RepeatUnit: TCTC  vs  TCTT   Skipping...
step2:STR:  WARNING: vcf row #173,374: 1-154381136-154381143-C-CTCTT (RU:TCTT:3), CTCTCTCTT (RU:TCTC:3): interrupted multi-allelic STR has alleles with different RepeatUnit: TCTT  vs  TCTC   Skipping...
step2:STR:  WARNING: vcf row #214,542: 1-183327059-183327066-G-GTATT (RU:TATT:3), GTATGTATT (RU:TATG:3): interrupted multi-allelic STR has alleles with different RepeatUnit: TATT  vs  TATG   Skipping...
step2:STR:  WARNING: vcf row #218,152: 1-186934444-186934463-C-CATATATATAT (RU:AT:1), CACACACACACACACAT (RU:AC:1): interrupted multi-allelic STR has alleles with different RepeatUnit: AT  vs  AC   Skipping...
step2:STR:  WARNING: vcf row #251,627: 1-209796635-209796676-A-AAC (RU:AC:1), AACACAAAC (RU:ACAC:1): interrupted multi-allelic STR has alleles with different RepeatUnit: AC  vs  ACAC   Skipping...
step2:STR:  WARNING: vcf row #264,335: 1-218123556-218123567-T-TATAC (RU:ATAC:1), TATATATATATATATAC (RU:AT:1): interrupted multi-allelic STR has alleles with different RepeatUnit: ATAC  vs  AT   Skipping...
step2:STR:  WARNING: vcf row #280,450: 1-230038191-230038286-G-GGAAGGAAA (RU:GAAG:3), GGAAGGAAGGAAAGAAAGAAAGAAA (RU:GAAA:3): interrupted multi-allelic STR has alleles with different RepeatUnit: GAAG  vs  GAAA   Skipping...
step2:STR:  WARNING: vcf row #289,517: 1-235688985-235689053-C-CAAT (RU:AAT:2), CAACAAT (RU:AAC:2): interrupted multi-allelic STR has alleles with different RepeatUnit: AAT  vs  AAC   Skipping...
step2:STR:  WARNING: vcf row #289,851: 1-235930447-235930486-A-AACACAGAC (RU:ACAC:1), AACACAGACACAC (RU:AC:1): interrupted multi-allelic STR has alleles with different RepeatUnit: ACAC  vs  AC   Skipping...
step2:STR:  WARNING: vcf row #291,982: 1-236669074-236669093-T-TTTCCTTCTTTCCTTCCTTCC (RU:TTCC:3), TTTCCTTCCTTCCTTCC (RU:TTCC:2): interrupted multi-allelic STR has alleles with different MotifInterruptionIndex: 3  vs  2   Skipping...
step2:STR:  WARNING: vcf row #355,238: 2-27642959-27642998-T-TATAC (RU:ATAC:1), TATACACACAC (RU:AC:1): interrupted multi-allelic STR has alleles with different RepeatUnit: ATAC  vs  AC   Skipping...
step2:STR:  WARNING: vcf row #362,372: 2-32668533-32668592-C-CCCTCCCTTCCTTCCTTCCTTCCTTCCTT (RU:CCTT:3), CCCTCCCTCCCTCCCTTCCTTCCTTCCTCCCTCCCTCCCTCCCTCCCTT (RU:CCTC:3): interrupted multi-allelic STR has alleles with different RepeatUnit: CCTT  vs  CCTC   Skipping...
step2:STR:  WARNING: vcf row #377,205: 2-42169317-42169328-C-CGCGCGG (RU:GCGCGG:3), CGCGCGCGCGCGG (RU:GCGC:3): interrupted multi-allelic STR has alleles with different RepeatUnit: GCGCGG  vs  GCGC   Skipping...
step2:STR:  WARNING: vcf row #399,734: 2-58584614-58584625-A-ATATG (RU:TATG:1), ATATATATATATG (RU:TA:1): interrupted multi-allelic STR has alleles with different RepeatUnit: TATG  vs  TA   Skipping...
step2:STR:  WARNING: vcf row #400,311: 2-59142015-59142054-G-GTCTATCTA (RU:TCTA:3), GTCTGTCTA (RU:TCTG:3): interrupted multi-allelic STR has alleles with different RepeatUnit: TCTA  vs  TCTG   Skipping...
step2:STR:  WARNING: vcf row #401,613: 2-60045101-60045108-T-TAGAC (RU:AGAC:3), TAGATAGATAGATAGATAGATAGATAGAC (RU:AGAT:3): interrupted multi-allelic STR has alleles with different RepeatUnit: AGAC  vs  AGAT   Skipping...
step2:STR:  WARNING: vcf row #408,748: 2-65748202-65748293-C-CTCTTTCTT (RU:TCTT:0), CTCTCTCTTTCTT (RU:TCTT:3): interrupted multi-allelic STR has alleles with different MotifInterruptionIndex: 0  vs  3   Skipping...
step2:STR:  WARNING: vcf row #435,493: 2-87201006-87201045-A-AAT (RU:AT:1), AAAATATATATATATAT (RU:ATAT:1): interrupted multi-allelic STR has alleles with different RepeatUnit: AT  vs  ATAT   Skipping...
step2:STR:  WARNING: vcf row #459,666: 2-115610492-115610511-G-GTGTGTGTA (RU:TGTG:3), GTGTGTGTGTA (RU:TG:1): interrupted multi-allelic STR has alleles with different RepeatUnit: TGTG  vs  TG   Skipping...
step2:STR:  WARNING: vcf row #484,817: 2-133810436-133810447-T-TAATAAG (RU:AAT:2), TAAGAAGAAGAAG (RU:AAG:2): interrupted multi-allelic STR has alleles with different RepeatUnit: AAT  vs  AAG   Skipping...
step2:STR:  WARNING: vcf row #509,028: 2-151957258-151957301-C-CGTGT (RU:GT:0), CGTGTATGT (RU:GTGT:0): interrupted multi-allelic STR has alleles with different RepeatUnit: GT  vs  GTGT   Skipping...
step2:STR:  WARNING: vcf row #526,302: 2-165611364-165611379-G-GTGTGTGTA (RU:TGTG:3), GTGTGTGTGTGTGTGTA (RU:TG:1): interrupted multi-allelic STR has alleles with different RepeatUnit: TGTG  vs  TG   Skipping...
step2:STR:  WARNING: vcf row #544,603: 2-177353891-177353900-T-TTA (RU:TA:1), TTATATATATATATTTA (RU:TATA:1): interrupted multi-allelic STR has alleles with different RepeatUnit: TA  vs  TATA   Skipping...
step2:STR:  WARNING: vcf row #558,813: 2-186625655-186625678-T-TGTGTGTGA (RU:GTGT:3), TGTGTGTGTGA (RU:GT:1): interrupted multi-allelic STR has alleles with different RepeatUnit: GTGT  vs  GT   Skipping...
step2:STR:  WARNING: vcf row #559,620: 2-187252243-187252286-G-GTTTATTTA (RU:TTTA:3), GTTTGTTTA (RU:TTTG:3): interrupted multi-allelic STR has alleles with different RepeatUnit: TTTA  vs  TTTG   Skipping...
step2:STR:  WARNING: vcf row #560,916: 2-188151855-188151884-A-AATG (RU:ATG:2), AATAATG (RU:ATA:2): interrupted multi-allelic STR has alleles with different RepeatUnit: ATG  vs  ATA   Skipping...
step2:STR:  WARNING: vcf row #564,570: 2-190834831-190834894-C-CTTTCTTTG (RU:TTTC:3), CTTTCTTTGTTTG (RU:TTTG:3): interrupted multi-allelic STR has alleles with different RepeatUnit: TTTC  vs  TTTG   Skipping...
step2:STR:  WARNING: vcf row #589,799: 2-209677404-209677439-T-TAGAC (RU:AGAC:3), TAGATAGAC (RU:AGAT:3): interrupted multi-allelic STR has alleles with different RepeatUnit: AGAC  vs  AGAT   Skipping...
step2:STR:  WARNING: vcf row #599,365: 2-215893224-215893263-G-GTGTGTGTC (RU:TGTG:3), GTGTGTGTGTC (RU:TG:1): interrupted multi-allelic STR has alleles with different RepeatUnit: TGTG  vs  TG   Skipping...
step2:STR:  WARNING: vcf row #599,513: 2-215954446-215954483-A-AACACACAC (RU:AC:3), AACAAACACACACACAC (RU:ACAC:3): interrupted multi-allelic STR has alleles with different RepeatUnit: AC  vs  ACAC   Skipping...
step2:STR:  WARNING: vcf row #602,878: 2-218315058-218315073-T-TCTTTCTTTCTTTCTTCCTTCCTTCCTTCCTTC (RU:CTTC:3), TCTTTCTTTCTTTCTTTCTTCCTTCCTTCCTTC (RU:CTTT:3): interrupted multi-allelic STR has alleles with different RepeatUnit: CTTC  vs  CTTT   Skipping...
