<!DOCTYPE html>
<html>
<head>
    <!-- Standard Meta -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

    <title>Genome-wide STR Truth Set</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css" integrity="sha512-8bHTC73gkZ7rZ7vpqUQThUDhqcNFyYi2xgDgPDHc+GXVGHXq+xPjynxIopALmOPqzo9JZj0k6OqqewdGO3EsrQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-G7WEXHL9KW"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-G7WEXHL9KW');
    </script>
    <style>
        /* tool comparison plot viewer */
        .ui.form {
            font-size: 16px;
        }
        .ui.form label {
            font-size: 16px;
        }
    </style>
</head>
<body>
<div class="ui stackable grid" style="padding: 0px 0px 0px 30px">
    <div class="ui row" style="padding-top: 20px; margin-top: 10px">
        <div class="ui eight wide column" style="min-width:820px">
            <ul>
                <li>
                    <div class="ui form">
                        <div class="inline fields">
                            <label style="min-width:150px">Tool:</label>
                            <div style="min-width: 70px">[<a class="prev-button" class="prev-button" id="prev-tool" href="#">&lt;</a> <a class="next-button" id="next-tool" href="#">&gt;</a>]</div>
                            <div class="field"><div class="ui radio checkbox"><input type="radio" value="ExpansionHunter" name="tool" checked="checked"><label>ExpansionHunter</label></div></div>
                            <div class="field"><div class="ui radio checkbox"><input type="radio" value="GangSTR" name="tool"><label>GangSTR</label></div></div>
                            <div class="field"><div class="ui radio checkbox"><input type="radio" value="HipSTR" name="tool"><label>HipSTR</label></div></div>
                        </div>
                    </div>
                </li>
                <li>
                    <div class="ui form">
                        <div class="inline fields">
                            <label style="min-width:150px">Motif Size:</label>
                            <div style="min-width: 70px">[<a class="prev-button" id="prev-motif-size" href="#">&lt;</a> <a class="next-button" id="next-motif-size" href="#">&gt;</a>]</div>
                            <div class="field"><div class="ui radio checkbox"><input type="radio" value="all_motifs" name="motif-size"><label>any</label></div></div>
                            <div class="field"><div class="ui radio checkbox"><input type="radio" value="2to6bp_motifs" name="motif-size" checked="checked"><label>2-6bp</label></div></div>
                            <div class="field"><div class="ui radio checkbox"><input type="radio" value="7to24bp_motifs" name="motif-size"><label>7-24bp</label></div></div>
                            <div class="field"><div class="ui radio checkbox"><input type="radio" value="25to50bp_motifs" name="motif-size"><label>25-50bp</label></div></div>
                        </div>
                    </div>
                </li>
                <li>
                    <div class="ui form">
                        <div class="inline fields">
                            <label style="min-width:150px">Genotype:</label>
                            <div style="min-width: 70px">[<a class="prev-button" id="prev-genotype" href="#">&lt;</a> <a class="next-button" id="next-genotype" href="#">&gt;</a>]</div>
                            <div class="field"><div class="ui radio checkbox"><input type="radio" value="all_genotypes" name="genotype" checked="checked"><label>any</label></div></div>
                            <div class="field"><div class="ui radio checkbox"><input type="radio" value="HET" name="genotype"><label>heterozygous</label></div></div>
                            <div class="field"><div class="ui radio checkbox"><input type="radio" value="HOM" name="genotype"><label>homozygous</label></div></div>
                            <div class="field"><div class="ui radio checkbox"><input type="radio" value="MULTI" name="genotype"><label>multi-allelic</label></div></div>
                        </div>
                    </div>
                </li>
                <li>
                    <div class="ui form">
                        <div class="inline fields">
                            <label style="min-width:150px">Coverage:</label>
                            <div style="min-width: 70px">[<a class="prev-button" id="prev-coverage" href="#">&lt;</a> <a class="next-button" id="next-coverage" href="#">&gt;</a>]</div>
                            <div class="field"><div class="ui radio checkbox"><input type="radio" value="40x" name="coverage" checked="checked"><label  style="white-space:nowrap">40x</label></div></div>
                            <div class="field"><div class="ui radio checkbox"><input type="radio" value="30x" name="coverage"><label style="white-space:nowrap">30x</label></div></div>
                            <div class="field"><div class="ui radio checkbox"><input type="radio" value="20x" name="coverage"><label style="white-space:nowrap">20x</label></div></div>
                            <div class="field"><div class="ui radio checkbox"><input type="radio" value="10x" name="coverage"><label style="white-space:nowrap">10x</label></div></div>
                            <div class="field"><div class="ui radio checkbox"><input type="radio" value="05x" name="coverage"><label style="white-space:nowrap">5x</label></div></div>
                            <div class="field"><div class="ui radio checkbox"><input type="radio" value="exome" name="coverage"><label style="white-space:nowrap">exome (85x)</label></div></div>
                        </div>
                    </div>
                </li>
                <li>
                    <div class="ui form">
                        <div class="inline fields">
                            <label style="min-width:150px">Allow Interruptions:</label>
                            <div style="min-width: 70px">[<a class="prev-button" id="prev-interruptions" href="#">&lt;</a> <a class="next-button" id="next-interruptions" href="#">&gt;</a>]</div>
                            <div class="field"><div class="ui radio checkbox"><input type="radio" value="pure_repeats" name="interruptions" checked="checked"><label>No: only pure repeats</label></div></div>
                            <div class="field"><div class="ui radio checkbox"><input type="radio" value="with_interruptions" name="interruptions"><label>Yes: only interrupted repeats</label></div></div>
                        </div>
                    </div>
                </li>
            </ul>
        </div>
        <div id="legend-row" style="padding-left:50px">
                <div style="float:right; padding: 0px 25px 25px 10px">[<a href="#" id="hide-legend">hide this legend</a>]</div>
                <b>x-axis:</b> represents the true allele size. Positive values are
                STR expansions, negative values are STR contractions.<br />
                <br />
                <b>Gray</b> represents loci where the tool didn't produce a genotype (i.e. due to errors or insufficient coverage).<br />
                <b>Red</b> is for loci that the tool called as homozygous reference and so entirely missed the variant. <br />
                <b>Brown</b> is when the tool incorrectly called an allele as being heterozygous reference.<br />
                <b>Teal</b> is where it called a contraction when the true allele is an expansion or vice versa.<br />
                <b>Blue</b> is for underestimated alleles (darker blue means underestimated by more repeats).<br />
                <b>Green</b> represents alleles where the tool exactly matched the true allele size. <br />
                <b>Orange</b> is for alleles that the tool overestimated (darker orange means a larger overestimate).<br />
        </div>
    </div>
</div>

<p>
    <img style="padding-top:30px; max-width:87%;" alt="image" id="tool-comparison-plot-viewer" src="https://storage.googleapis.com/str-truth-set/hg38/figures/tool_accuracy_by_true_allele_size.2to6bp_motifs.all_genotypes.pure_repeats.40x.ExpansionHunter.svg" />
</p>

<!-- script section -->
<script src="https://code.jquery.com/jquery-3.1.1.min.js"  integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.js" integrity="sha512-dqw6X88iGgZlTsONxZK9ePmJEFrmHwpuMrsUChjAw1mRUhUITE5QU9pkcSox+ynfLhL15Sv2al5A0LVyDCmtUw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>

    $('.ui.checkbox').checkbox();
    $('.prev-button').click((e) => {
        const linkId = e.target.id
        const name = linkId.replace(/^prev-/, '')
        const radioButtons = [...document.querySelectorAll(`input[name="${name}"]`)];
        const current = radioButtons.findIndex(btn => btn.checked);
        let idx = (current - 1) % radioButtons.length
        if (idx < 0) {
            idx = radioButtons.length - 1
        }
        radioButtons[idx].click();
        radioButtons[idx].checked = true;
    });

    $('.next-button').click((e) => {
        const linkId = e.target.id
        const name = linkId.replace(/^next-/, '')
        const radioButtons = [...document.querySelectorAll(`input[name="${name}"]`)];
        const current = radioButtons.findIndex(btn => btn.checked);
        const idx = (current + 1) % radioButtons.length
        radioButtons[idx].click();
        radioButtons[idx].checked = true;
    });

    let update_tool_comparison_plot_viewer_image_url = () => {
        const tool = $('input[name="tool"]:checked').val()
        const motif_size = $('input[name="motif-size"]:checked').val()
        const genotype = $('input[name="genotype"]:checked').val()
        const coverage = $('input[name="coverage"]:checked').val()
        const interruptions = $('input[name="interruptions"]:checked').val()


        //let img_url = "https://broadinstitute.github.io/str-truth-set/tool_comparison/figures/"
        let img_url = "https://storage.googleapis.com/str-truth-set/hg38/figures/"
        img_url += `tool_accuracy_by_true_allele_size.${motif_size}.${genotype}.${interruptions}.${coverage}.${tool}.svg`

        $('#tool-comparison-plot-viewer').attr("src", img_url)
    }

    $('input[type="radio"]').on("change", update_tool_comparison_plot_viewer_image_url);
    $('#hide-legend').click(() => {
        $('#legend-row').hide()
    })
    
</script>
</body>
</html>
